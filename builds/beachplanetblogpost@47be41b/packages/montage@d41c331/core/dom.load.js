montageDefine("d41c331","core/dom",{dependencies:["./geometry/point"],factory:function(t,e){var n=t("./geometry/point").Point,i=Node.prototype,r=Element.prototype;Object.defineProperty(r,"set",{value:function(t,e,n){var i,r,a,s,o,l=t.indexOf(".",n);n=n||0,r=t.substring(n,-1===l?t.length:l),-1===l?this.setAttribute(r,e):(a=t.lastIndexOf("."),"style"===r?(s=t.substring(l+1,t.length),this.style[s]=e):"classList"===r?(o=t.substring(l+1,t.length),e?this.classList.add(o):this.classList.remove(o)):(i=this.get(t.substring(0,a)))&&(i[t.substring(a+1,t.length)]=e))},enumerable:!1}),i.get=function(t){return this.getAttribute(t)||this[t]},Object.getPrototypeOf(document).addRule=function(t,e){var n,i;if(null==(n=document.styleSheets[0])){var r=document.createElement("style");r.type="text/css",document.head.appendChild(r),n=document.styleSheets[0]}else i=document.getRule(t,n);i||n.insertRule(t+" "+e,n.cssRules.length)},Object.getPrototypeOf(document).getRule=function(t,e){var n;if(e.cssRules)for(var i=0;n=e.cssRules[i];i++){if(n.name&&n.name===t)return n;if(n.selectorText===t)return n}},"undefined"!=typeof Element&&function(){var t="classList";if(!Element.prototype.hasOwnProperty(t)){var e=/^\s+|\s+$/g,n=function(t,e){t.setAttribute("class",e.join(" "))},i=function(t,e){if(""===e)throw"SYNTAX_ERR";if(/\s/.test(e))throw"INVALID_CHARACTER_ERR";return t.indexOf(e)},r=function(){var t=this,r=t.getAttribute("class")||"";return r=r.replace(e,"").split(/\s+/),{length:r.length,item:function(t){return r[t]||null},contains:function(t){return-1!==i(r,t)},add:function(e){-1===i(r,e)&&(r.push(e),this.length=r.length,n(t,r))},remove:function(e){var a=i(r,e);-1!==a&&(r.splice(a,1),this.length=r.length,n(t,r))},toggle:function(t){-1===i(r,t)?this.add(t):this.remove(t)},toString:function(){return t.getAttribute("class")||""}}};Object.defineProperty?Object.defineProperty(Element.prototype,t,{get:r,enumerable:!0}):Object.prototype.__defineGetter__&&Element.prototype.__defineGetter__(t,r)}}(),i.parentOf=function(t){for(;(t=t.parentNode)&&t!==this;);return t?!0:!1};var a=function(t){var e,n,i,r,a=t.ownerDocument;if(t&&a){if(n=a.documentElement,i=a.body,r=a.defaultView,t!==i){if(e=t.getBoundingClientRect(),n.parentOf(t)){var s=n.clientTop||i.clientTop||0,o=n.clientLeft||i.clientLeft||0,l=r.pageYOffset||n.scrollTop||i.scrollTop,c=r.pageXOffset||n.scrollLeft||i.scrollLeft,h=e.top+l-s,u=e.left+c-o;return{top:h,left:u}}return{top:e.top,left:e.left}}return{top:i.offsetTop,left:i.offsetLeft}}return null},s=null,o=function(){e.convertPointFromNodeToPage=function(t,e){return e?(s.x=e.x,s.y=e.y):(s.x=0,s.y=0),e=webkitConvertPointFromNodeToPage(t,s),e?(new n).init(e.x,e.y):null},e.convertPointFromPageToNode=function(t,e){return e?(s.x=e.x,s.y=e.y):(s.x=0,s.y=0),e=webkitConvertPointFromPageToNode(t,s),e?(new n).init(e.x,e.y):null}},l=function(){e.convertPointFromNodeToPage=function(t,e){if(!t||t.x!==void 0)return null;var i;return(i=a(t))?(new n).init((e?e.x:0)+i.left,(e?e.y:0)+i.top):(new n).init(e?e.x:0,e?e.y:0)},e.convertPointFromPageToNode=function(t,e){if(!t||t.x!==void 0)return null;var i;return(i=a(t))?(new n).init((e?e.x:0)-i.left,(e?e.y:0)-i.top):(new n).init(e?e.x:0,e?e.y:0)}};"undefined"!=typeof WebKitPoint?(s=new WebKitPoint(0,0),o()):l()}});