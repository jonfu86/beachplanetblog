montageDefine("d41c331","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./shim/string","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","./deprecate","./uuid","collections/listen/property-changes","frb","collections/weak-map","collections/map","frb/parse","frb/evaluate","frb/assign","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(t,e){function n(t,e){var i=a+e+r;return t.hasOwnProperty(i)?t[i]:Object.defineProperty(t,i,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(n(Object.getPrototypeOf(t),e))})[i]}t("collections/shim"),t("./shim/object"),t("./shim/array"),t("./shim/string"),t("./extras/object"),t("./extras/date"),t("./extras/element"),t("./extras/function"),t("./extras/regexp"),t("./extras/string");var i=t("./deprecate"),r="AttributeProperties",a="_",s="__proto__",o="value",l="enumerable",c="distinct",h="serializable",u=Array.prototype,d=Object.prototype,p=!0,m=e.Montage=function m(){};m.deprecate=i.deprecateMethod(m,i.deprecateMethod,"Montage.deprecate","deprecate module's deprecateMethod"),m.callDeprecatedFunction=i.deprecateMethod(m,i.callDeprecatedFunction,"Montage.callDeprecatedFunction","deprecate module's callDeprecatedFunction");var g={}.__proto__===Object.prototype,f={_montage_metadata:1,__state__:1},v=Object.getOwnPropertyNames(Function);if(Object.defineProperty(m,"specialize",{value:function(t,e){var n,r,a,s,o,l,c,h=this,u=this.specialize===void 0;if(t=t||Object.empty,e=e||Object.empty,n=t.constructor&&t.constructor.value?t.constructor.value:t.didCreate&&t.didCreate.value?m.deprecate(null,t.didCreate.value,"didCreate","constructor"):function(){return this.superForValue("constructor")()||this},g)n.__proto__=h;else{a=Object.getOwnPropertyNames(h);for(var l=0;a.length>l;l++)s=a[l],f.hasOwnProperty(s)||(o=Object.getOwnPropertyDescriptor(n,s),(!o||o.configurable)&&m.defineProperty(n,s,Object.getOwnPropertyDescriptor(h,s)));n.__constructorProto__=h,m.defineProperty(n,"isPrototypeOf",{value:function(t){for(;null!==t;){if(Object.getPrototypeOf(t)===this)return!0;t=Object.getPrototypeOf(t)}return!1},enumerable:!1})}if(r=Object.create(this.prototype),u){for(a=Object.getOwnPropertyNames(m),l=0;a.length>l;l++)s=a[l],o=Object.getOwnPropertyDescriptor(n,s),(!o||o.configurable)&&m.defineProperty(n,s,Object.getOwnPropertyDescriptor(m,s));for(a=Object.getOwnPropertyNames(m.prototype),l=0;a.length>l;l++)s=a[l],o=Object.getOwnPropertyDescriptor(n,s),(!o||o.configurable)&&m.defineProperty(r,s,Object.getOwnPropertyDescriptor(m.prototype,s))}if(m.defineProperties(r,t),p){c=function(t,e,n){function r(){return this===e&&i.deprecationWarning(m.getInfoForObject(e).objectName+"."+n+" should be moved to constructorProperties",null,3),t.apply(this,arguments)}return r.deprecatedFunction=t,r};for(s in t)v.has(s)?delete t[s]:(o=t[s],o.value&&"function"==typeof o.value&&!o.value.__isConstructor__?o.value=c(o.value,n,s):(o.get&&(o.get=c(o.get,n,s)),o.set&&(o.set=c(o.set,n,s))));m.defineProperties(n,t),m.defineProperty(n,"create",{value:function(){return new n},enumerable:!1})}return m.defineProperties(n,e),m.defineProperty(n,"__isConstructor__",{value:!0,enumerable:!1}),m.defineProperty(n,"_superCache",{value:{},enumerable:!1}),n.prototype=r,m.defineProperty(r,"constructor",{value:n,enumerable:!1}),n},writable:!0,configurable:!0,enumerable:!1}),!g){var _=Object.getPrototypeOf;Object.getPrototypeOf=function(t){return"function"==typeof t&&t.__constructorProto__?t.__constructorProto__:_.apply(Object,arguments)}}Object.defineProperty(m,"create",{configurable:!0,value:function(t,e){if(i.deprecationWarning("Montage.create()","Montage.specialize() or new Component()"),void 0!==t&&"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null, not '"+t+"'");if(t=t===void 0?this:t,"function"==typeof t)return e?t.specialize(e):new t;var n=Object.create(t);return e&&m.defineProperties(n,e),n}});var y=[h];y.forEach(function(t){Object.defineProperty(Object.prototype,a+t+r,{enumerable:!1,configurable:!1,writable:!0,value:{}})}),Object.defineProperty(m,"defineProperty",{value:function(t,e,i){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object must be an object, not '"+t+"'");var r=o in i;if(c in i&&!r)throw new TypeError("Cannot use distinct attribute on non-value property '"+e+"'");if(s in i)i.__proto__=r?"function"==typeof i.value?b:L:C;else{var p;p=r?"function"==typeof i.value?b:L:C;for(var m in p)m in i||(i[m]=p[m])}if(i.hasOwnProperty(l)||e.charAt(0)!==a||(i.enumerable=!1),i.hasOwnProperty(h)||(i.enumerable?i.get&&!i.set?i.serializable=!1:i.writable===!1&&(i.serializable=!1):i.serializable=!1),h in i&&(n(t,h)[e]=i.serializable),i.distinct!==!0||"object"!=typeof i.value){var g,f,v;if(t._superDependencies){if("function"==typeof i.value&&(g=t._superDependencies[e+".value"]))for(f=0,v=g.length;v>f;f++)delete g[f]._superCache[e+".value"];if("function"==typeof i.get&&(g=t._superDependencies[e+".get"]))for(f=0,v=g.length;v>f;f++)delete g[f]._superCache[e+".get"];if("function"==typeof i.set&&(g=t._superDependencies[e+".set"]))for(f=0,v=g.length;v>f;f++)delete g[f]._superCache[e+".set"]}return Object.defineProperty(t,e,i)}(function(t,e,n,i){var r=function(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:n})};n.constructor===Object&&Object.getPrototypeOf(n)===d?0!==Object.keys(n).length?Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];if(!t){var i;t={};for(i in n)t[i]=n[i];this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}}):Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];return t||(t={},this.hasOwnProperty(e)?this[e]=t:r(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}}):(n.__proto__||Object.getPrototypeOf(n))===u?0!==n.length?Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];if(!t){var i,a;for(t=[],i=0;(a=n[i])!==void 0;i++)t[i]=a;this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}}):Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];return t||(t=[],this.hasOwnProperty(e)?this[e]=t:r(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}}):n.constructor.prototype===Object.getPrototypeOf(n)?Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];if(!t){var i;t=new n.constructor;for(i in n)t[i]=n[i];this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}}):Object.defineProperty(i,t,{configurable:!0,get:function(){var t=this[e];return t||(t=Object.create(n.__proto__||Object.getPrototypeOf(n)),this.hasOwnProperty(e)?this[e]=t:r(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:r(this,e,t)}})})(e,a+e,i.value,t)}}),Object.defineProperty(m,"defineProperties",{value:function(t,e){if("object"!=typeof e||null===e)throw new TypeError("Properties must be an object, not '"+e+"'");for(var n in e)"_bindingDescriptors"!==n&&this.defineProperty(t,n,e[n]);return t}});var C={enumerable:!0,configurable:!0,serializable:!0},L={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},b={writable:!0,enumerable:!1,configurable:!0,serializable:!1};m.defineProperty(m,"didCreate",{value:Function.noop});var w=function(t,e){var n,i,r,a,s,o,l,c,h;if(!e._superPropertyName||!e._superPropertyType)for(m.defineProperty(e,"_superPropertyType",{value:null}),m.defineProperty(e,"_superPropertyName",{value:null}),l=t;!c&&null!==l;){for(n=Object.getOwnPropertyNames(l),i=Object.getPrototypeOf(l),r=0,a=n.length,r;a>r;r++){if(s=n[r],h=Object.getOwnPropertyDescriptor(l,s),null!=(o=h.value)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="value",e._superPropertyName=s,c=!0;break}if(null!=(o=h.get)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="get",e._superPropertyName=s,c=!0;break}if(null!=(o=h.set)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="set",e._superPropertyName=s,c=!0;break}}l=i}return M(t,e._superPropertyType,e._superPropertyName,e)},x=function(){if("function"!=typeof x.caller)throw new TypeError("Can't get super without caller. Use this.superForValue(methodName) if using strict mode.");var t=w(this,x.caller);return"function"==typeof t?t.bind(this):Function.noop};m.defineProperty(m,"_superContext",{value:null});var M=function(t,e,n,i){var r,a,s,o,l,c=t,h=n+"."+e;if(t._superContext||(t._superContext={}),t._superContext[h])c=t._superContext[h];else for(c=t;null!==c&&(!c.hasOwnProperty(n)||(s=Object.getOwnPropertyDescriptor(c,n),"function"!=typeof s[e]));)c=Object.getPrototypeOf(c);if(o=c.constructor,o._superCache&&o._superCache[h])return l=function(t,e,n,i){return function(){e._superContext[t]=n;var r=i.apply(e,arguments);return delete e._superContext[t],r}}(h,t,o._superCache[h].owner,o._superCache[h].func);for(a=c;r===void 0&&(a=Object.getPrototypeOf(a));)if(a._superDependencies||m.defineProperty(a,"_superDependencies",{value:{}}),a._superDependencies[h]||(a._superDependencies[h]=[]),a._superDependencies[h].push(o),s=Object.getOwnPropertyDescriptor(a,n)){if("function"==typeof s[e]&&s[e]!==i){r=s[e];break}break}return"function"==typeof r?(l=function(t,e,n,i){return function(){e._superContext[t]=n;var r=i.apply(e,arguments);return delete e._superContext[t],r}}(h,t,a,r),o._superCache||m.defineProperty(o,"_superCache",{value:{}}),o._superCache[h]={func:r,owner:a},l):Function.noop},T=function(t){return M(this,"value",t,T.caller)},S=function(t){return M(this,"get",t,S.caller)},E=function(t){return M(this,"set",t,E.caller)};m.defineProperty(m,"super",{get:x,enumerable:!1}),m.defineProperty(m.prototype,"super",{get:x,enumerable:!1}),m.defineProperty(m,"superForValue",{value:T,enumerable:!1}),m.defineProperty(m.prototype,"superForValue",{value:T,enumerable:!1}),m.defineProperty(m,"superForGet",{value:S,enumerable:!1}),m.defineProperty(m.prototype,"superForGet",{value:S,enumerable:!1}),m.defineProperty(m,"superForSet",{value:E,enumerable:!1}),m.defineProperty(m.prototype,"superForSet",{value:E,enumerable:!1}),m.defineProperty(m,"getSerializablePropertyNames",{value:function(t){var e=[],n=t._serializableAttributeProperties;if(n)for(var i in n)n[i]&&e.push(i);return e}}),m.defineProperty(m,"getPropertyAttribute",{value:function(t,e,n){var i=a+n+r,s=t[i];return s?s[e]:void 0}}),m.defineProperty(m,"getPropertyAttributes",{value:function(t,e){var n={},i=a+e+r,s=t[i];if(s){for(var o in s)n[o]=s[o];return n}}});var A={isInstance:{value:!0}},z={objectName:{value:"Function"},isInstance:{value:!0}};m.defineProperty(m,"getInfoForObject",{value:function(t){var e,n;if(D.call(t,"_montage_metadata"))return t._montage_metadata;if(e=t._montage_metadata||t.constructor&&t.constructor._montage_metadata||null,n=t.constructor===Function?z:A,t===Object.prototype)return Object.create(e,n);try{return Object.defineProperty(t,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(e,n)})._montage_metadata}catch(i){return t._montage_metadata=Object.create(e,n)}}});var O=t("./uuid");"undefined"!=typeof window&&(window.uuid=O.generate());var D=Object.prototype.hasOwnProperty,P=function(){var t=O.generate(),e=m.getInfoForObject(this);try{null!==e&&e.isInstance===!1?(this._uuid=t,Object.defineProperty(this,"uuid",{get:function(){return this.hasOwnProperty("uuid")?this._uuid:P.call(this)}})):(e.isInstance&&Object.defineProperty(this,"uuid",{configurable:!0,enumerable:!1,writable:!1,value:t}),!(this instanceof Element)&&e.isInstance&&o in(Object.getOwnPropertyDescriptor(this,"uuid")||{})&&s in this||(this._uuid=t))}catch(n){}return this._uuid=t,t},R=function R(){return D.call(this,"_uuid")?this._uuid:P.call(this)};Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,value:null,writable:!0}),Object.defineProperty(Object.prototype,"uuid",{configurable:!0,get:R,set:function(){}}),m.defineProperty(m,"identifier",{value:null,serializable:!0}),m.defineProperty(m.prototype,"identifier",{value:null,serializable:!0}),m.defineProperty(m.prototype,"equals",{value:function(t){return t?this===t||this.uuid===t.uuid:!1}}),m.defineProperty(m,"equals",{value:m.prototype.equals}),m.defineProperty(m.prototype,"callDelegateMethod",{value:function(t){var e,n,i=this.delegate;return"string"==typeof this.identifier&&(e=this.identifier+t.toCapitalized(),i&&"function"==typeof(n=i[e]))?(u.shift.call(arguments),n.apply(i,arguments)):i&&"function"==typeof(n=i[t])?(u.shift.call(arguments),n.apply(i,arguments)):void 0}});var I=t("collections/listen/property-changes");Object.addEach(m,I.prototype),Object.addEach(m.prototype,I.prototype);var B=e.Bindings=t("frb"),N={defineBinding:{value:function(t,e,n){return B.defineBinding(this,t,e,n)}},defineBindings:{value:function(t,e){return B.defineBindings(this,t,e)}},cancelBinding:{value:function(t){return B.cancelBinding(this,t)}},cancelBindings:{value:function(){return B.cancelBindings(this)}},getBinding:{value:function(t){return B.getBinding(this,t)}},getBindings:{value:function(){return B.getBindings(this)}}};m.defineProperties(m,N),m.defineProperties(m.prototype,N);var F=t("collections/weak-map"),k=t("collections/map"),V=t("frb/parse"),G=t("frb/evaluate"),j=t("frb/assign");t("frb/bind");var q=t("frb/compile-observer"),U=t("frb/scope"),W=t("frb/observers"),H=W.autoCancelPrevious,Y=new F,X={getPath:{value:function(t,e,n,i){return G(t,this,e||this,n,i)}},setPath:{value:function(t,e,n,i,r){return j(this,t,e,n||this,i,r)}},observePath:{value:function(t,e){var n=V(t),i=q(n);return i(H(e),new U(this))}},addRangeAtPathChangeListener:{value:function(t,e,n,i,r,a){function s(t,i,r){if(e[n])e[n](t,i,r);else{if(!e.call)throw Error("Can't dispatch range change to "+e);e.call(null,t,i,r)}}n=n||"handleRangeChange";var o=[];return this.addPathChangeListener(t,function(t){return t&&t.toArray&&t.addRangeChangeListener?(s(t.toArray(),o.toArray(),0),o=t,t.addRangeChangeListener(s)):(t=[],s(t,o,0),o=t,void 0)},void 0,void 0,i,r,a)}},getPathChangeDescriptors:{value:function(){return Y.has(this)||Y.set(this,{}),Y.get(this)}},getPathChangeDescriptor:{value:function(t,e,n){var i=m.getPathChangeDescriptors.call(this);return Object.owns(i,t)||(i[t]={willChangeListeners:new k,changeListeners:new k}),i=i[t],i=n?i.willChangeListeners:i.changeListeners,i.has(e)||i.set(e,{path:t,handler:e,beforeChange:n,cancel:Function.noop}),i.get(e)}},addPathChangeListener:{value:function(t,e,n,i,r,a,s){var o=this;e=e||Function.noop;var l=m.getPathChangeDescriptor.call(this,t,e,i);l.cancel();var c,h,u,d=V(t);if(e===Function.noop)u=function(e){if(h)throw Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(t));h=!0,c=e};else if(n)u=function(i){return e[n].call(e,i,t,o)};else if(e.handlePathChange)u=function(n){return e.handlePathChange.call(e,n,t,o)};else{if("function"!=typeof e)throw Error("Can't recognize handler type: "+e+". Must be function or delegate implementing handlePathChange.");u=function(n){return e.call(o,n,t,o)}}var p=q(d),g=new U(this);g.beforeChange=i,g.parameters=r,g.document=a,g.components=s;var f=p(H(u),g);return l.cancel=f,h?c:f}},removePathChangeListener:{value:function(t,e,n){e=e||Function.noop;var i=m.getPathChangeDescriptors.call(this),r=n?"willChangeListeners":"changeListeners";if(!Object.owns(i,t))throw Error("Can't find "+r+" for "+JSON.stringify(t));var a=i[t],s=a[r];if(!s.has(e))throw Error("Can't find "+r+" for "+JSON.stringify(t));var o=s.get(e);o.cancel(),s["delete"](e),0===a.willChangeListeners.length&&0===a.changeListeners.length&&delete i[t];for(var l in i)return;Y["delete"](this)}},addBeforePathChangeListener:{value:function(t,e,n,i,r,a){return m.addPathChangeListener.call(this,t,e,n,!0,i,r,a)}},removeBeforePathChangeListener:{value:function(t,e){return m.removePathChangeListener.call(this,t,e,!0)}}};m.defineProperties(m,X),m.defineProperties(m.prototype,X),t("./serialization/bindings"),e._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var t=m.getInfoForObject(this),e=t&&!t.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(e,"_blueprintModuleId")||!e._blueprintModuleId){t=m.getInfoForObject(e);var n=t.moduleId,i=n.lastIndexOf("/"),r=n.lastIndexOf(".");i=-1===i?0:i+1,r=-1===r?n.length:r,r=i>r?n.length:r,m.defineProperty(e,"_blueprintModuleId",{enumerable:!1,value:n.slice(0,r)+".meta"})}return e._blueprintModuleId}},e._blueprintDescriptor={serializable:!1,enumerable:!1,get:function(){var n=m.getInfoForObject(this),i=n&&!n.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(i,"_blueprint")||!i._blueprint){var r=i.blueprintModuleId;if(""===r)throw new TypeError("Blueprint moduleId undefined for the module '"+JSON.stringify(i)+"'");e._blueprintDescriptor.BlueprintModulePromise||(e._blueprintDescriptor.BlueprintModulePromise=t.async("core/meta/module-blueprint").get("ModuleBlueprint")),m.defineProperty(i,"_blueprint",{enumerable:!1,value:e._blueprintDescriptor.BlueprintModulePromise.then(function(t){var e=m.getInfoForObject(i);return t.getBlueprintWithModuleId(r,e.require).fail(function(e){if(-1!==e.message.indexOf("Can't XHR"))return t.createDefaultBlueprintForObject(i).then(function(t){return t});throw e})})})}return i._blueprint},set:function(e){var n,i=m.getInfoForObject(this),r=i&&!i.isInstance?this:this.constructor;if(null===e)n=null;else{if("function"==typeof e.then)throw new TypeError("Object blueprint should not be a promise");e.blueprintInstanceModule=r.blueprintModule,n=t("./promise").Promise.resolve(e)}m.defineProperty(r,"_blueprint",{enumerable:!1,value:n})}}}});