exports.o3dgc=function(){"use strict";function t(){var t,e,n;return e=new ArrayBuffer(4),t=new Uint32Array(e),n=new Uint8Array(e),t[0]=1,1===n[0]?c.O3DGC_LITTLE_ENDIAN:c.O3DGC_BIG_ENDIAN}function e(t,e,n,i){var a,r,s,o,l,h,p;for(a=-1,r=!1,o=e.m_value,l=0,s=l;o>s;++s){if(t.Equal(n[s].m_id)){r=!0;break}if(t.Less(n[s].m_id)){for(e.m_value<c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&++e.m_value,h=e.m_value-1;h>s;--h)for(n[h].m_id.m_a=n[h-1].m_id.m_a,n[h].m_id.m_b=n[h-1].m_id.m_b,n[h].m_id.m_c=n[h-1].m_id.m_c,p=0;i>p;++p)n[h].m_pred[p]=n[h-1].m_pred[p];n[s].m_id.m_a=t.m_a,n[s].m_id.m_b=t.m_b,n[s].m_id.m_c=t.m_c,a=s,r=!0;break}}return!r&&e.m_value<c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS&&(a=e.m_value++,n[a].m_id.m_a=t.m_a,n[a].m_id.m_b=t.m_b,n[a].m_id.m_c=t.m_c),a}function n(t,e){var n,i,a;n=Math.abs(t.m_x),i=Math.abs(t.m_y),a=Math.abs(t.m_z),a>=n&&a>=i?t.m_z>=0?(e.m_z=0,e.m_x=t.m_x,e.m_y=t.m_y):(e.m_z=1,e.m_x=-t.m_x,e.m_y=-t.m_y):i>=n&&i>=a?t.m_y>=0?(e.m_z=2,e.m_x=t.m_z,e.m_y=t.m_x):(e.m_z=3,e.m_x=-t.m_z,e.m_y=-t.m_x):t.m_x>=0?(e.m_z=4,e.m_x=t.m_y,e.m_y=t.m_z):(e.m_z=5,e.m_x=-t.m_y,e.m_y=-t.m_z)}function i(t){return 0>t?-1-2*t:2*t}function a(t){return 1&t?-(t+1>>>1):t>>>1}function r(t,n,i,a,r,s,o,c){var h,p,u,d,g,m;for(m=new l.SC3DMCTriplet(-1,-1,-1),p=0;3>p;++p)if(d=t[3*n+p],i>d&&(m.m_a=-1,m.m_b=-1,m.m_c=d,u=e(m,a,r,s),-1!==u))for(h=d*c,g=0;s>g;++g)r[u].m_pred[g]=o[h+g]}function s(t,n,i,a,r,s,o,c,h,p){var u,d,g,m,f,v,y,L,_,C,x,w,b,M,z,S,T,E;if(u=3*n,E=new l.SC3DMCTriplet(-1,-1,-1),t[u]===i?(v=t[u+1],y=t[u+2]):t[u+1]===i?(v=t[u],y=t[u+2]):(v=t[u],y=t[u+1]),i>v&&i>y)for(w=h.Begin(v),b=h.End(v),M=w;b>M&&(z=p[M],!(0>z));++M){for(d=3*z,L=-1,S=!1,x=0;3>x;++x)_=t[d+x],_===y?S=!0:i>_&&_!==v&&(L=_);if(-1!==L&&S&&(y>v?(E.m_a=v,E.m_b=y):(E.m_a=y,E.m_b=v),E.m_c=-L-1,T=e(E,a,r,s),-1!==T))for(g=v*c,m=y*c,f=L*c,C=0;s>C;++C)r[T].m_pred[C]=o[g+C]+o[m+C]-o[f+C]}}function o(t,e,n,i,a){var r,s,o,c,h,p,u,d,g,m;for(m=new l.Vec3,d=new l.Vec3,g=new l.Vec3,o=3*i,s=0;o>s;++s)a[s]=0;for(c=0;e>c;++c)r=3*c,h=3*t[r],p=3*t[r+1],u=3*t[r+2],d.m_x=n[p]-n[h],d.m_y=n[p+1]-n[h+1],d.m_z=n[p+2]-n[h+2],g.m_x=n[u]-n[h],g.m_y=n[u+1]-n[h+1],g.m_z=n[u+2]-n[h+2],m.m_x=d.m_y*g.m_z-d.m_z*g.m_y,m.m_y=d.m_z*g.m_x-d.m_x*g.m_z,m.m_z=d.m_x*g.m_y-d.m_y*g.m_x,a[h]+=m.m_x,a[h+1]+=m.m_y,a[h+2]+=m.m_z,a[p]+=m.m_x,a[p+1]+=m.m_y,a[p+2]+=m.m_z,a[u]+=m.m_x,a[u+1]+=m.m_y,a[u+2]+=m.m_z}var l,c;return l={},c={},c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0=7,c.O3DGC_BINARY_STREAM_MAX_SYMBOL0=127,c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1=6,c.O3DGC_BINARY_STREAM_MAX_SYMBOL1=63,c.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32=5,c.O3DGC_BIG_ENDIAN=0,c.O3DGC_LITTLE_ENDIAN=1,c.O3DGC_MAX_DOUBLE=1.79769e308,c.O3DGC_MIN_LONG=-2147483647,c.O3DGC_MAX_LONG=2147483647,c.O3DGC_MAX_UCHAR8=255,c.O3DGC_MAX_TFAN_SIZE=256,c.O3DGC_MAX_ULONG=4294967295,c.O3DGC_SC3DMC_START_CODE=497,c.O3DGC_DV_START_CODE=498,c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES=256,c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES=256,c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES=32,c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS=2,c.O3DGC_SC3DMC_BINARIZATION_FL=0,c.O3DGC_SC3DMC_BINARIZATION_BP=1,c.O3DGC_SC3DMC_BINARIZATION_FC=2,c.O3DGC_SC3DMC_BINARIZATION_AC=3,c.O3DGC_SC3DMC_BINARIZATION_AC_EGC=4,c.O3DGC_SC3DMC_BINARIZATION_ASCII=5,c.O3DGC_STREAM_TYPE_UNKOWN=0,c.O3DGC_STREAM_TYPE_ASCII=1,c.O3DGC_STREAM_TYPE_BINARY=2,c.O3DGC_SC3DMC_NO_PREDICTION=0,c.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION=1,c.O3DGC_SC3DMC_XOR_PREDICTION=2,c.O3DGC_SC3DMC_ADAPTIVE_DIFFERENTIAL_PREDICTION=3,c.O3DGC_SC3DMC_CIRCULAR_DIFFERENTIAL_PREDICTION=4,c.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION=5,c.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION=6,c.O3DGC_SC3DMC_ENCODE_MODE_QBCR=0,c.O3DGC_SC3DMC_ENCODE_MODE_SVA=1,c.O3DGC_SC3DMC_ENCODE_MODE_TFAN=2,c.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT=0,c.O3DGC_MIN_NEIGHBORS_SIZE=128,c.O3DGC_MIN_NUM_NEIGHBORS_SIZE=16,c.O3DGC_TFANS_MIN_SIZE_ALLOCATED_VERTICES_BUFFER=128,c.O3DGC_TFANS_MIN_SIZE_TFAN_SIZE_BUFFER=8,c.O3DGC_DEFAULT_VECTOR_SIZE=32,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_UNKOWN=0,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_POSITION=1,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_NORMAL=2,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_COLOR=3,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_TEXCOORD=4,l.O3DGC_IFS_FLOAT_ATTRIBUTE_TYPE_WEIGHT=5,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_UNKOWN=0,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX=1,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_JOINT_ID=2,l.O3DGC_IFS_INT_ATTRIBUTE_TYPE_INDEX_BUFFER_ID=3,l.O3DGC_OK=0,l.O3DGC_ERROR_BUFFER_FULL=1,l.O3DGC_ERROR_CORRUPTED_STREAM=5,l.O3DGC_ERROR_NON_SUPPORTED_FEATURE=6,l.O3DGC_ERROR_AC=7,l.SC3DMCStats=function(){this.m_timeCoord=0,this.m_timeNormal=0,this.m_timeCoordIndex=0,this.m_timeFloatAttribute=new Float32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_timeIntAttribute=new Float32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_timeReorder=0,this.m_streamSizeCoord=0,this.m_streamSizeNormal=0,this.m_streamSizeCoordIndex=0,this.m_streamSizeFloatAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_streamSizeIntAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES)},l.SC3DMCTriplet=function(t,e,n){this.m_a=t,this.m_b=e,this.m_c=n},l.SC3DMCTriplet.prototype.Less=function(t){var e;return e=this.m_c!==t.m_c?this.m_c<t.m_c:this.m_b!==t.m_b?this.m_b<t.m_b:this.m_a<t.m_a},l.SC3DMCTriplet.prototype.Equal=function(t){return this.m_c===t.m_c&&this.m_b===t.m_b&&this.m_a===t.m_a},l.SC3DMCPredictor=function(){this.m_id=new l.SC3DMCTriplet(-1,-1,-1),this.m_pred=new Float32Array(c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES)},window.performance===void 0&&(window.performance={}),window.performance.now||(c.nowOffset=Date.now(),performance.timing&&performance.timing.navigationStart&&(c.nowOffset=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-c.nowOffset}),l.Timer=function(){this.m_start=0,this.m_end=0},l.Timer.prototype.Tic=function(){this.m_start=window.performance.now()},l.Timer.prototype.Toc=function(){this.m_end=window.performance.now()},l.Timer.prototype.GetElapsedTime=function(){return this.m_end-this.m_start},l.Vec3=function(t,e,n){this.m_x=t,this.m_y=e,this.m_z=n},l.Vec3.prototype.Set=function(t,e,n){this.m_x=t,this.m_y=e,this.m_z=n},l.Vec3.prototype.Sub=function(t,e){this.m_x=t.m_x-e.m_x,this.m_y=t.m_y-e.m_y,this.m_z=t.m_z-e.m_z},l.Vec3.prototype.Add=function(t,e){this.m_x=t.m_x+e.m_x,this.m_y=t.m_y+e.m_y,this.m_z=t.m_z+e.m_z},l.Vec3.prototype.SelfAdd=function(t){this.m_x+=t.m_x,this.m_y+=t.m_y,this.m_z+=t.m_z},l.Vec3.prototype.Cross=function(t,e){this.m_x=t.m_y*e.m_z-t.m_z*e.m_y,this.m_y=t.m_z*e.m_x-t.m_x*e.m_z,this.m_z=t.m_x*e.m_y-t.m_y*e.m_x},l.Vec3.prototype.GetNorm=function(){return Math.sqrt(this.m_x*this.m_x+this.m_y*this.m_y+this.m_z*this.m_z)},c.CubeToSphere={0:function(t,e){e.m_x=t.m_x,e.m_y=t.m_y,e.m_z=Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_y*e.m_y))},1:function(t,e){e.m_x=-t.m_x,e.m_y=-t.m_y,e.m_z=-Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_y*e.m_y))},2:function(t,e){e.m_z=t.m_x,e.m_x=t.m_y,e.m_y=Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_z*e.m_z))},3:function(t,e){e.m_z=-t.m_x,e.m_x=-t.m_y,e.m_y=-Math.sqrt(Math.max(0,1-e.m_x*e.m_x-e.m_z*e.m_z))},4:function(t,e){e.m_y=t.m_x,e.m_z=t.m_y,e.m_x=Math.sqrt(Math.max(0,1-e.m_y*e.m_y-e.m_z*e.m_z))},5:function(t,e){e.m_y=-t.m_x,e.m_z=-t.m_y,e.m_x=-Math.sqrt(Math.max(0,1-e.m_y*e.m_y-e.m_z*e.m_z))}},l.Iterator=function(){this.m_count=0},l.NumberRef=function(){this.m_value=0},l.BinaryStream=function(e){this.m_endianness=t(),this.m_buffer=e,this.m_stream=new Uint8Array(this.m_buffer),this.m_localBuffer=new ArrayBuffer(4),this.m_localBufferViewUChar8=new Uint8Array(this.m_localBuffer),this.m_localBufferViewFloat32=new Float32Array(this.m_localBuffer),this.m_localBufferViewUInt32=new Uint32Array(this.m_localBuffer)},l.BinaryStream.prototype.ReadFloat32Bin=function(t){return this.m_endianness===c.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++]),this.m_localBufferViewFloat32[0]},l.BinaryStream.prototype.ReadUInt32Bin=function(t){return this.m_endianness===c.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++]):(this.m_localBufferViewUChar8[0]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[1]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[2]=this.m_stream[t.m_count++],this.m_localBufferViewUChar8[3]=this.m_stream[t.m_count++]),this.m_localBufferViewUInt32[0]},l.BinaryStream.prototype.ReadUChar8Bin=function(t){return this.m_stream[t.m_count++]},l.BinaryStream.prototype.ReadUInt32ASCII=function(t){var e,n,i;for(e=0,n=0,i=0;c.O3DGC_BINARY_STREAM_NUM_SYMBOLS_UINT32>i;++i)e+=this.m_stream[t.m_count++]<<n>>>0,n+=c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0;return e},l.BinaryStream.prototype.ReadFloat32ASCII=function(t){var e=this.ReadUInt32ASCII(t);return this.m_endianness===c.O3DGC_BIG_ENDIAN?(this.m_localBufferViewUChar8[3]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[2]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[1]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[0]=e&c.O3DGC_MAX_UCHAR8):(this.m_localBufferViewUChar8[0]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[1]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[2]=e&c.O3DGC_MAX_UCHAR8,e>>>=8,this.m_localBufferViewUChar8[3]=e&c.O3DGC_MAX_UCHAR8),this.m_localBufferViewFloat32[0]},l.BinaryStream.prototype.ReadIntASCII=function(t){return a(this.ReadUIntASCII(t))},l.BinaryStream.prototype.ReadUIntASCII=function(t){var e,n,i;if(i=this.m_stream[t.m_count++],i===c.O3DGC_BINARY_STREAM_MAX_SYMBOL0){e=0;do n=this.m_stream[t.m_count++],i+=n>>>1<<e>>>0,e+=c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL1;while(1&n)}return i},l.BinaryStream.prototype.ReadUCharASCII=function(t){return this.m_stream[t.m_count++]},l.BinaryStream.prototype.ReadFloat32=function(t,e){return e===c.O3DGC_STREAM_TYPE_ASCII?this.ReadFloat32ASCII(t):this.ReadFloat32Bin(t)},l.BinaryStream.prototype.ReadUInt32=function(t,e){return e===c.O3DGC_STREAM_TYPE_ASCII?this.ReadUInt32ASCII(t):this.ReadUInt32Bin(t)},l.BinaryStream.prototype.ReadUChar=function(t,e){return e===c.O3DGC_STREAM_TYPE_ASCII?this.ReadUCharASCII(t):this.ReadUChar8Bin(t)},l.BinaryStream.prototype.GetBuffer=function(t,e){return new Uint8Array(this.m_buffer,t.m_count,e)},c.O3DGC_AC_MIN_LENGTH=16777216,c.O3DGC_AC_MAX_LENGTH=4294967295,c.O3DGC_AC_BM_LENGTH_SHIFT=13,c.O3DGC_AC_BM_MAX_COUNT=1<<c.O3DGC_AC_BM_LENGTH_SHIFT>>>0,c.O3DGC_AC_DM_LENGTH_SHIFT=15,c.O3DGC_AC_DM_MAX_COUNT=1<<c.O3DGC_AC_DM_LENGTH_SHIFT>>>0,l.StaticBitModel=function(){this.m_bit0Prob=1<<c.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0},l.StaticBitModel.prototype.SetProbability=function(t){this.m_bit0Prob=Math.floor(t*(1<<c.O3DGC_AC_BM_LENGTH_SHIFT>>>0))},l.AdaptiveBitModel=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<c.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},l.AdaptiveBitModel.prototype.Reset=function(){this.m_updateCycle=4,this.m_bitsUntilUpdate=4,this.m_bit0Prob=1<<c.O3DGC_AC_BM_LENGTH_SHIFT-1>>>0,this.m_bit0Count=1,this.m_bitCount=2},l.AdaptiveBitModel.prototype.Update=function(){(this.m_bitCount+=this.m_updateCycle)>c.O3DGC_AC_BM_MAX_COUNT&&(this.m_bitCount=this.m_bitCount+1>>>1,this.m_bit0Count=this.m_bit0Count+1>>>1,this.m_bit0Count===this.m_bitCount&&++this.m_bitCount);var t=Math.floor(2147483648/this.m_bitCount);this.m_bit0Prob=this.m_bit0Count*t>>>31-c.O3DGC_AC_BM_LENGTH_SHIFT,this.m_updateCycle=5*this.m_updateCycle>>>2,this.m_updateCycle>64&&(this.m_updateCycle=64),this.m_bitsUntilUpdate=this.m_updateCycle},l.AdaptiveDataModel=function(){this.m_buffer={},this.m_distribution={},this.m_symbolCount={},this.m_decoderTable={},this.m_totalCount=0,this.m_updateCycle=0,this.m_symbolsUntilUpdate=0,this.m_dataSymbols=0,this.m_lastSymbol=0,this.m_tableSize=0,this.m_tableShift=0},l.AdaptiveDataModel.prototype.Update=function(){var t,e,n,i,a,r,s;if((this.m_totalCount+=this.m_updateCycle)>c.O3DGC_AC_DM_MAX_COUNT)for(this.m_totalCount=0,t=0;this.m_dataSymbols>t;++t)this.m_totalCount+=this.m_symbolCount[t]=this.m_symbolCount[t]+1>>>1;if(e=0,n=0,i=Math.floor(2147483648/this.m_totalCount),0===this.m_tableSize)for(a=0;this.m_dataSymbols>a;++a)this.m_distribution[a]=i*e>>>31-c.O3DGC_AC_DM_LENGTH_SHIFT,e+=this.m_symbolCount[a];else{for(a=0;this.m_dataSymbols>a;++a)for(this.m_distribution[a]=i*e>>>31-c.O3DGC_AC_DM_LENGTH_SHIFT,e+=this.m_symbolCount[a],s=this.m_distribution[a]>>>this.m_tableShift;s>n;)this.m_decoderTable[++n]=a-1;for(this.m_decoderTable[0]=0;this.m_tableSize>=n;)this.m_decoderTable[++n]=this.m_dataSymbols-1}this.m_updateCycle=5*this.m_updateCycle>>>2,r=this.m_dataSymbols+6<<3>>>0,this.m_updateCycle>r&&(this.m_updateCycle=r),this.m_symbolsUntilUpdate=this.m_updateCycle},l.AdaptiveDataModel.prototype.Reset=function(){var t;if(0!==this.m_dataSymbols){for(this.m_totalCount=0,this.m_updateCycle=this.m_dataSymbols,t=0;this.m_dataSymbols>t;++t)this.m_symbolCount[t]=1;this.Update(),this.m_symbolsUntilUpdate=this.m_updateCycle=this.m_dataSymbols+6>>>1}},l.AdaptiveDataModel.prototype.SetAlphabet=function(t){if(2>t||t>2048)return Console.log("invalid number of data symbols"),l.O3DGC_ERROR_AC;if(this.m_dataSymbols!==t)if(this.m_dataSymbols=t,this.m_lastSymbol=this.m_dataSymbols-1,this.m_dataSymbols>16){for(var e=3;this.m_dataSymbols>1<<e+2>>>0;)++e;this.m_tableSize=1<<e>>>0,this.m_tableShift=c.O3DGC_AC_DM_LENGTH_SHIFT-e,this.m_buffer=new ArrayBuffer(4*(2*this.m_dataSymbols+this.m_tableSize+2)),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable=new Uint32Array(this.m_buffer,8*this.m_dataSymbols,this.m_tableSize+2)}else this.m_tableSize=this.m_tableShift=0,this.m_buffer=new ArrayBuffer(8*this.m_dataSymbols),this.m_distribution=new Uint32Array(this.m_buffer,0,this.m_dataSymbols),this.m_symbolCount=new Uint32Array(this.m_buffer,4*this.m_dataSymbols,this.m_dataSymbols),this.m_decoderTable={};return this.Reset(),l.O3DGC_OK},l.ArithmeticDecoder=function(){this.m_codeBuffer={},this.m_acShift=0,this.m_base=0,this.m_value=0,this.m_length=0,this.m_bufferSize=0,this.m_mode=0},l.ArithmeticDecoder.prototype.SetBuffer=function(t,e){return 0===t?(Console.log("invalid codec buffer size"),l.O3DGC_ERROR_AC):0!==this.m_mode?(Console.log("cannot set buffer while encoding or decoding"),l.O3DGC_ERROR_AC):(this.m_bufferSize=t,this.m_codeBuffer=e,void 0)},l.ArithmeticDecoder.prototype.StartDecoder=function(){return 0!==this.m_mode?(Console.log("cannot start decoder"),l.O3DGC_ERROR_AC):0===this.m_bufferSize?(Console.log("no code buffer set"),l.O3DGC_ERROR_AC):(this.m_mode=2,this.m_length=c.O3DGC_AC_MAX_LENGTH,this.m_acShift=3,this.m_value=(this.m_codeBuffer[0]<<24|this.m_codeBuffer[1]<<16|this.m_codeBuffer[2]<<8|this.m_codeBuffer[3])>>>0,void 0)},l.ArithmeticDecoder.prototype.StopDecoder=function(){return 2!==this.m_mode?(Console.log("invalid to stop decoder"),l.O3DGC_ERROR_AC):(this.m_mode=0,void 0)},l.ArithmeticDecoder.prototype.GetBit=function(){this.m_length>>>=1;var t=this.m_value>=this.m_length;return t&&(this.m_value-=this.m_length),this.m_length<c.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),t},l.ArithmeticDecoder.prototype.GetBits=function(t){var e=Math.floor(this.m_value/(this.m_length>>>=t));return this.m_value-=this.m_length*e,this.m_length<c.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),e},l.ArithmeticDecoder.prototype.DecodeStaticBitModel=function(t){var e,n;return e=t.m_bit0Prob*(this.m_length>>>c.O3DGC_AC_BM_LENGTH_SHIFT),n=this.m_value>=e,n?(this.m_value-=e,this.m_length-=e):this.m_length=e,this.m_length<c.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),n},l.ArithmeticDecoder.prototype.DecodeAdaptiveBitModel=function(t){var e,n;return e=t.m_bit0Prob*(this.m_length>>>c.O3DGC_AC_BM_LENGTH_SHIFT),n=this.m_value>=e,n?(this.m_value-=e,this.m_length-=e):(this.m_length=e,++t.m_bit0Count),this.m_length<c.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),0===--t.m_bitsUntilUpdate&&t.Update(),n},l.ArithmeticDecoder.prototype.DecodeAdaptiveDataModel=function(t){var e,n,i,a,r,s,o,l;if(a=this.m_length,t.m_tableSize>0){for(s=Math.floor(this.m_value/(this.m_length>>>=c.O3DGC_AC_DM_LENGTH_SHIFT)),r=s>>>t.m_tableShift,n=t.m_decoderTable[r],e=t.m_decoderTable[r+1]+1;e>n+1;)l=n+e>>>1,t.m_distribution[l]>s?e=l:n=l;i=t.m_distribution[n]*this.m_length,n!==t.m_lastSymbol&&(a=t.m_distribution[n+1]*this.m_length)}else{i=n=0,this.m_length>>>=c.O3DGC_AC_DM_LENGTH_SHIFT,l=(e=t.m_dataSymbols)>>>1;do o=this.m_length*t.m_distribution[l],o>this.m_value?(e=l,a=o):(n=l,i=o);while((l=n+e>>>1)!==n)}return this.m_value-=i,this.m_length=a-i,this.m_length<c.O3DGC_AC_MIN_LENGTH&&this.RenormDecInterval(),++t.m_symbolCount[n],0===--t.m_symbolsUntilUpdate&&t.Update(!1),n},l.ArithmeticDecoder.prototype.ExpGolombDecode=function(t,e,n){var i,a,r;i=0,a=0;do r=this.DecodeAdaptiveBitModel(n),r&&(i+=1<<t>>>0,t++);while(r);for(;t--;)this.DecodeStaticBitModel(e)&&(a=(a|1<<t)>>>0);return i+a},l.ArithmeticDecoder.prototype.RenormDecInterval=function(){do this.m_value=(this.m_value<<8|this.m_codeBuffer[++this.m_acShift])>>>0,this.m_length=this.m_length<<8>>>0;while(this.m_length<c.O3DGC_AC_MIN_LENGTH)},l.ArithmeticDecoder.prototype.DecodeIntACEGC=function(t,e,n,i,r){var s=this.DecodeAdaptiveDataModel(t);return s===r&&(s+=this.ExpGolombDecode(i,e,n)),a(s)},l.ArithmeticDecoder.prototype.DecodeUIntACEGC=function(t,e,n,i,a){var r=this.DecodeAdaptiveDataModel(t);return r===a&&(r+=this.ExpGolombDecode(i,e,n)),r},l.FIFO=function(){this.m_data={},this.m_allocated=0,this.m_size=0,this.m_start=0,this.m_end=0},l.FIFO.prototype.Clear=function(){this.m_start=this.m_end=this.m_size=0},l.FIFO.prototype.GetAllocatedSize=function(){return this.m_allocated},l.FIFO.prototype.GetSize=function(){return this.m_size},l.FIFO.prototype.Allocate=function(t){return t>this.m_allocated&&(this.m_allocated=t,this.m_data=new Int32Array(this.m_allocated)),this.Clear(),l.O3DGC_OK},l.FIFO.prototype.PopFirst=function(){--this.m_size;var t=this.m_start++;return this.m_start===this.m_allocated&&(this.m_end=0),this.m_data[t]},l.FIFO.prototype.PushBack=function(t){--this.m_size,this.m_data[this.m_end]=t,++this.m_size,++this.m_end,this.m_end===this.m_allocated&&(this.m_end=0)},l.IndexedFaceSet=function(){this.m_nCoordIndex=0,this.m_nCoord=0,this.m_nNormal=0,this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_creaseAngle=30,this.m_ccw=!0,this.m_solid=!0,this.m_convex=!0,this.m_isTriangularMesh=!0,this.m_coordMin=new Float32Array(3),this.m_coordMax=new Float32Array(3),this.m_normalMin=new Float32Array(3),this.m_normalMax=new Float32Array(3),this.m_nFloatAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_nIntAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_dimFloatAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_dimIntAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_typeFloatAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_typeIntAttribute=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_minFloatAttributeBuffer=new ArrayBuffer(4*c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minFloatAttribute=new Float32Array(this.m_minFloatAttributeBuffer),this.m_maxFloatAttributeBuffer=new ArrayBuffer(4*c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_maxFloatAttribute=new Float32Array(this.m_maxFloatAttributeBuffer),this.m_coordIndex={},this.m_coord={},this.m_normal={},this.m_floatAttribute=[],this.m_intAttribute=[]},l.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},l.IndexedFaceSet.prototype.GetNCoordIndex=function(){return this.m_nCoordIndex},l.IndexedFaceSet.prototype.GetNCoord=function(){return this.m_nCoord},l.IndexedFaceSet.prototype.GetNNormal=function(){return this.m_nNormal},l.IndexedFaceSet.prototype.GetNFloatAttribute=function(t){return this.m_nFloatAttribute[t]},l.IndexedFaceSet.prototype.GetNIntAttribute=function(t){return this.m_nIntAttribute[t]},l.IndexedFaceSet.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},l.IndexedFaceSet.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},l.IndexedFaceSet.prototype.GetCoordMinArray=function(){return this.m_coordMin},l.IndexedFaceSet.prototype.GetCoordMaxArray=function(){return this.m_coordMax},l.IndexedFaceSet.prototype.GetNormalMinArray=function(){return this.m_normalMin},l.IndexedFaceSet.prototype.GetNormalMaxArray=function(){return this.m_normalMax},l.IndexedFaceSet.prototype.GetFloatAttributeMinArray=function(t){return new Float32Array(this.m_minFloatAttributeBuffer,4*t*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(t))},l.IndexedFaceSet.prototype.GetFloatAttributeMaxArray=function(t){return new Float32Array(this.m_maxFloatAttributeBuffer,4*t*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES,this.GetFloatAttributeDim(t))},l.IndexedFaceSet.prototype.GetFloatAttributeDim=function(t){return this.m_dimFloatAttribute[t]},l.IndexedFaceSet.prototype.GetIntAttributeDim=function(t){return this.m_dimIntAttribute[t]},l.IndexedFaceSet.prototype.GetFloatAttributeType=function(t){return this.m_typeFloatAttribute[t]},l.IndexedFaceSet.prototype.GetIntAttributeType=function(t){return this.m_typeIntAttribute[t]},l.IndexedFaceSet.prototype.GetFloatAttributeMax=function(t,e){return this.m_maxFloatAttribute[t*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]},l.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},l.IndexedFaceSet.prototype.GetCreaseAngle=function(){return this.m_creaseAngle},l.IndexedFaceSet.prototype.GetCCW=function(){return this.m_ccw},l.IndexedFaceSet.prototype.GetSolid=function(){return this.m_solid},l.IndexedFaceSet.prototype.GetConvex=function(){return this.m_convex},l.IndexedFaceSet.prototype.GetIsTriangularMesh=function(){return this.m_isTriangularMesh},l.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},l.IndexedFaceSet.prototype.GetCoordIndex=function(){return this.m_coordIndex},l.IndexedFaceSet.prototype.GetCoord=function(){return this.m_coord},l.IndexedFaceSet.prototype.GetNormal=function(){return this.m_normal},l.IndexedFaceSet.prototype.GetFloatAttribute=function(t){return this.m_floatAttribute[t]},l.IndexedFaceSet.prototype.GetIntAttribute=function(t){return this.m_intAttribute[t]},l.IndexedFaceSet.prototype.SetNCoordIndex=function(t){this.m_nCoordIndex=t},l.IndexedFaceSet.prototype.SetNNormalIndex=function(){},l.IndexedFaceSet.prototype.SetNormalPerVertex=function(){},l.IndexedFaceSet.prototype.SetNFloatAttributeIndex=function(){},l.IndexedFaceSet.prototype.SetNIntAttributeIndex=function(){},l.IndexedFaceSet.prototype.SetFloatAttributePerVertex=function(){},l.IndexedFaceSet.prototype.SetIntAttributePerVertex=function(){},l.IndexedFaceSet.prototype.SetNCoord=function(t){this.m_nCoord=t},l.IndexedFaceSet.prototype.SetNNormal=function(t){this.m_nNormal=t},l.IndexedFaceSet.prototype.SetNumFloatAttributes=function(t){this.m_numFloatAttributes=t},l.IndexedFaceSet.prototype.SetNumIntAttributes=function(t){this.m_numIntAttributes=t},l.IndexedFaceSet.prototype.SetCreaseAngle=function(t){this.m_creaseAngle=t},l.IndexedFaceSet.prototype.SetCCW=function(t){this.m_ccw=t},l.IndexedFaceSet.prototype.SetSolid=function(t){this.m_solid=t},l.IndexedFaceSet.prototype.SetConvex=function(t){this.m_convex=t},l.IndexedFaceSet.prototype.SetIsTriangularMesh=function(t){this.m_isTriangularMesh=t},l.IndexedFaceSet.prototype.SetCoordMin=function(t,e){this.m_coordMin[t]=e},l.IndexedFaceSet.prototype.SetCoordMax=function(t,e){this.m_coordMax[t]=e},l.IndexedFaceSet.prototype.SetNormalMin=function(t,e){this.m_normalMin[t]=e},l.IndexedFaceSet.prototype.SetNormalMax=function(t,e){this.m_normalMax[t]=e},l.IndexedFaceSet.prototype.SetNFloatAttribute=function(t,e){this.m_nFloatAttribute[t]=e},l.IndexedFaceSet.prototype.SetNIntAttribute=function(t,e){this.m_nIntAttribute[t]=e},l.IndexedFaceSet.prototype.SetFloatAttributeDim=function(t,e){this.m_dimFloatAttribute[t]=e},l.IndexedFaceSet.prototype.SetIntAttributeDim=function(t,e){this.m_dimIntAttribute[t]=e},l.IndexedFaceSet.prototype.SetFloatAttributeType=function(t,e){this.m_typeFloatAttribute[t]=e},l.IndexedFaceSet.prototype.SetIntAttributeType=function(t,e){this.m_typeIntAttribute[t]=e},l.IndexedFaceSet.prototype.SetFloatAttributeMin=function(t,e,n){this.m_minFloatAttribute[t*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]=n},l.IndexedFaceSet.prototype.SetFloatAttributeMax=function(t,e,n){this.m_maxFloatAttribute[t*c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES+e]=n},l.IndexedFaceSet.prototype.SetCoordIndex=function(t){this.m_coordIndex=t},l.IndexedFaceSet.prototype.SetCoord=function(t){this.m_coord=t},l.IndexedFaceSet.prototype.SetNormal=function(t){this.m_normal=t},l.IndexedFaceSet.prototype.SetFloatAttribute=function(t,e){this.m_floatAttribute[t]=e},l.IndexedFaceSet.prototype.SetIntAttribute=function(t,e){this.m_intAttribute[t]=e},l.SC3DMCEncodeParams=function(){var t;for(this.m_numFloatAttributes=0,this.m_numIntAttributes=0,this.m_floatAttributeQuantBits=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_floatAttributePredMode=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES),this.m_intAttributePredMode=new Uint32Array(c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES),this.m_encodeMode=c.O3DGC_SC3DMC_ENCODE_MODE_TFAN,this.m_streamTypeMode=c.O3DGC_STREAM_TYPE_ASCII,this.m_coordQuantBits=14,this.m_normalQuantBits=8,this.m_coordPredMode=c.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,this.m_normalPredMode=c.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION,t=0;c.O3DGC_SC3DMC_MAX_NUM_FLOAT_ATTRIBUTES>t;++t)this.m_floatAttributePredMode[t]=c.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION;for(t=0;c.O3DGC_SC3DMC_MAX_NUM_INT_ATTRIBUTES>t;++t)this.m_intAttributePredMode[t]=c.O3DGC_SC3DMC_DIFFERENTIAL_PREDICTION},l.SC3DMCEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},l.SC3DMCEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},l.SC3DMCEncodeParams.prototype.GetNumFloatAttributes=function(){return this.m_numFloatAttributes},l.SC3DMCEncodeParams.prototype.GetNumIntAttributes=function(){return this.m_numIntAttributes},l.SC3DMCEncodeParams.prototype.GetCoordQuantBits=function(){return this.m_coordQuantBits},l.SC3DMCEncodeParams.prototype.GetNormalQuantBits=function(){return this.m_normalQuantBits},l.SC3DMCEncodeParams.prototype.GetFloatAttributeQuantBits=function(t){return this.m_floatAttributeQuantBits[t]},l.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},l.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},l.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(t){return this.m_floatAttributePredMode[t]},l.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(t){return this.m_intAttributePredMode[t]},l.SC3DMCEncodeParams.prototype.GetCoordPredMode=function(){return this.m_coordPredMode},l.SC3DMCEncodeParams.prototype.GetNormalPredMode=function(){return this.m_normalPredMode},l.SC3DMCEncodeParams.prototype.GetFloatAttributePredMode=function(t){return this.m_floatAttributePredMode[t]},l.SC3DMCEncodeParams.prototype.GetIntAttributePredMode=function(t){return this.m_intAttributePredMode[t]},l.SC3DMCEncodeParams.prototype.SetStreamType=function(t){this.m_streamTypeMode=t},l.SC3DMCEncodeParams.prototype.SetEncodeMode=function(t){this.m_encodeMode=t},l.SC3DMCEncodeParams.prototype.SetNumFloatAttributes=function(t){this.m_numFloatAttributes=t},l.SC3DMCEncodeParams.prototype.SetNumIntAttributes=function(t){this.m_numIntAttributes=t},l.SC3DMCEncodeParams.prototype.SetCoordQuantBits=function(t){this.m_coordQuantBits=t},l.SC3DMCEncodeParams.prototype.SetNormalQuantBits=function(t){this.m_normalQuantBits=t},l.SC3DMCEncodeParams.prototype.SetFloatAttributeQuantBits=function(t,e){this.m_floatAttributeQuantBits[t]=e},l.SC3DMCEncodeParams.prototype.SetCoordPredMode=function(t){this.m_coordPredMode=t},l.SC3DMCEncodeParams.prototype.SetNormalPredMode=function(t){this.m_normalPredMode=t},l.SC3DMCEncodeParams.prototype.SetFloatAttributePredMode=function(t,e){this.m_floatAttributePredMode[t]=e},l.SC3DMCEncodeParams.prototype.SetIntAttributePredMode=function(t,e){this.m_intAttributePredMode[t]=e},l.AdjacencyInfo=function(){this.m_neighborsSize=0,this.m_numNeighborsSize=0,this.m_numElements=0,this.m_neighbors={},this.m_numNeighbors={}},l.AdjacencyInfo.prototype.Allocate=function(t,e){return this.m_numElements=t,e>this.m_neighborsSize&&(this.m_neighborsSize=e,this.m_neighbors=new Int32Array(this.m_neighborsSize)),t>this.m_numNeighborsSize&&(this.m_numNeighborsSize=t,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),l.O3DGC_OK},l.AdjacencyInfo.prototype.AllocateNumNeighborsArray=function(t){return t>this.m_numNeighborsSize&&(this.m_numNeighborsSize=t,this.m_numNeighbors=new Int32Array(this.m_numNeighborsSize)),this.m_numElements=t,l.O3DGC_OK},l.AdjacencyInfo.prototype.AllocateNeighborsArray=function(){var t;for(t=1;this.m_numElements>t;++t)this.m_numNeighbors[t]+=this.m_numNeighbors[t-1];return this.m_numNeighbors[this.m_numElements-1]>this.m_neighborsSize&&(this.m_neighborsSize=this.m_numNeighbors[this.m_numElements-1],this.m_neighbors=new Int32Array(this.m_neighborsSize)),l.O3DGC_OK},l.AdjacencyInfo.prototype.ClearNumNeighborsArray=function(){var t;for(t=0;this.m_numElements>t;++t)this.m_numNeighbors[t]=0;return l.O3DGC_OK},l.AdjacencyInfo.prototype.ClearNeighborsArray=function(){var t;for(t=0;this.m_neighborsSize>t;++t)this.m_neighbors[t]=-1;return l.O3DGC_OK},l.AdjacencyInfo.prototype.Begin=function(t){return t>0?this.m_numNeighbors[t-1]:0},l.AdjacencyInfo.prototype.End=function(t){return this.m_numNeighbors[t]},l.AdjacencyInfo.prototype.AddNeighbor=function(t,e){var n,i,a;for(i=this.Begin(t),a=this.End(t),n=i;a>n;++n)if(-1===this.m_neighbors[n])return this.m_neighbors[n]=e,l.O3DGC_OK;return l.O3DGC_ERROR_BUFFER_FULL},l.AdjacencyInfo.prototype.GetNeighbor=function(t){return this.m_neighbors[t]},l.AdjacencyInfo.prototype.GetNumNeighbors=function(t){return this.End(t)-this.Begin(t)},l.AdjacencyInfo.prototype.GetNumNeighborsBuffer=function(){return this.m_numNeighbors},l.AdjacencyInfo.prototype.GetNeighborsBuffer=function(){return this.m_neighbors},l.Vector=function(){this.m_data={},this.m_allocated=0,this.m_size=0},l.Vector.prototype.Clear=function(){this.m_size=0},l.Vector.prototype.Get=function(t){return this.m_data[t]},l.Vector.prototype.GetAllocatedSize=function(){return this.m_allocated},l.Vector.prototype.GetSize=function(){return this.m_size},l.Vector.prototype.GetBuffer=function(){return this.m_data},l.Vector.prototype.SetSize=function(t){this.m_size=t},l.Vector.prototype.Allocate=function(t){var e,n;if(t>this.m_allocated){if(this.m_allocated=t,n=new Int32Array(this.m_allocated),this.m_size>0)for(e=0;this.m_size>e;++e)n[e]=this.m_data[e];this.m_data=n}},l.Vector.prototype.PushBack=function(t){var e,n;if(this.m_size===this.m_allocated){if(this.m_allocated*=2,this.m_allocated<c.O3DGC_DEFAULT_VECTOR_SIZE&&(this.m_allocated=c.O3DGC_DEFAULT_VECTOR_SIZE),n=new Int32Array(this.m_allocated),this.m_size>0)for(e=0;this.m_size>e;++e)n[e]=this.m_data[e];this.m_data=n}this.m_data[this.m_size++]=t},l.CompressedTriangleFans=function(){this.m_numTFANs=new l.Vector,this.m_degrees=new l.Vector,this.m_configs=new l.Vector,this.m_operations=new l.Vector,this.m_indices=new l.Vector,this.m_trianglesOrder=new l.Vector,this.m_streamType=c.O3DGC_STREAM_TYPE_UNKOWN
},l.CompressedTriangleFans.prototype.GetStreamType=function(){return this.m_streamType},l.CompressedTriangleFans.prototype.SetStreamType=function(t){this.m_streamType=t},l.CompressedTriangleFans.prototype.Clear=function(){return this.m_numTFANs.Clear(),this.m_degrees.Clear(),this.m_configs.Clear(),this.m_operations.Clear(),this.m_indices.Clear(),l.O3DGC_OK},l.CompressedTriangleFans.prototype.Allocate=function(t,e){return this.m_numTFANs.Allocate(t),this.m_degrees.Allocate(2*t),this.m_configs.Allocate(2*t),this.m_operations.Allocate(2*t),this.m_indices.Allocate(2*t),this.m_trianglesOrder.Allocate(e),this.Clear(),l.O3DGC_OK},l.CompressedTriangleFans.prototype.PushNumTFans=function(t){this.m_numTFANs.PushBack(t)},l.CompressedTriangleFans.prototype.ReadNumTFans=function(t){return this.m_numTFANs.Get(t.m_count++)},l.CompressedTriangleFans.prototype.PushDegree=function(t){this.m_degrees.PushBack(t)},l.CompressedTriangleFans.prototype.ReadDegree=function(t){return this.m_degrees.Get(t.m_count++)},l.CompressedTriangleFans.prototype.PushConfig=function(t){this.m_configs.PushBack(t)},l.CompressedTriangleFans.prototype.ReadConfig=function(t){return this.m_configs.Get(t.m_count++)},l.CompressedTriangleFans.prototype.PushOperation=function(t){this.m_operations.PushBack(t)},l.CompressedTriangleFans.prototype.ReadOperation=function(t){return this.m_operations.Get(t.m_count++)},l.CompressedTriangleFans.prototype.PushIndex=function(t){this.m_indices.PushBack(t)},l.CompressedTriangleFans.prototype.ReadIndex=function(t){return this.m_indices.Get(t.m_count++)},l.CompressedTriangleFans.prototype.PushTriangleIndex=function(t){this.m_trianglesOrder.PushBack(i(t))},l.CompressedTriangleFans.prototype.ReadTriangleIndex=function(t){return a(this.m_trianglesOrder.Get(t.m_count++))},l.CompressedTriangleFans.prototype.LoadUIntData=function(t,e,n){var i,a;for(e.ReadUInt32ASCII(n),i=e.ReadUInt32ASCII(n),t.Allocate(i),t.Clear(),a=0;i>a;++a)t.PushBack(e.ReadUIntASCII(n));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadIntData=function(t,e,n){var i,a;for(e.ReadUInt32ASCII(n),i=e.ReadUInt32ASCII(n),t.Allocate(i),t.Clear(),a=0;i>a;++a)t.PushBack(e.ReadIntASCII(n));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadBinData=function(t,e,n){var i,a,r,s;for(e.ReadUInt32ASCII(n),i=e.ReadUInt32ASCII(n),t.Allocate(i*c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0),t.Clear(),r=0;i>r;)for(a=e.ReadUCharASCII(n),s=0;c.O3DGC_BINARY_STREAM_BITS_PER_SYMBOL0>s;++s)t.PushBack(1&a),a>>>=1,++r;return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadUIntAC=function(t,e,n,i){var a,r,s,o,c,h,p;if(a=n.ReadUInt32Bin(i)-12,r=n.ReadUInt32Bin(i),0===r)return l.O3DGC_OK;for(s=n.ReadUInt32Bin(i),o=n.GetBuffer(i,a),i.m_count+=a,t.Allocate(r),c=new l.ArithmeticDecoder,c.SetBuffer(a,o),c.StartDecoder(),h=new l.AdaptiveDataModel,h.SetAlphabet(e+1),p=0;r>p;++p)t.PushBack(c.DecodeAdaptiveDataModel(h)+s);return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadIntACEGC=function(t,e,n,i){var a,r,s,o,h,p,u,d,g,m;if(a=n.ReadUInt32Bin(i)-12,r=n.ReadUInt32Bin(i),0===r)return l.O3DGC_OK;for(s=n.ReadUInt32Bin(i)-c.O3DGC_MAX_LONG,o=n.GetBuffer(i,a),i.m_count+=a,t.Allocate(r),h=new l.ArithmeticDecoder,h.SetBuffer(a,o),h.StartDecoder(),p=new l.AdaptiveDataModel,p.SetAlphabet(e+2),u=new l.StaticBitModel,d=new l.AdaptiveBitModel,m=0;r>m;++m)g=h.DecodeAdaptiveDataModel(p),g===e&&(g+=h.ExpGolombDecode(0,u,d)),t.PushBack(g+s);return l.O3DGC_OK},l.CompressedTriangleFans.prototype.LoadBinAC=function(t,e,n){var i,a,r,s,o,c;if(i=e.ReadUInt32Bin(n)-8,a=e.ReadUInt32Bin(n),0===a)return l.O3DGC_OK;for(r=e.GetBuffer(n,i),n.m_count+=i,t.Allocate(a),s=new l.ArithmeticDecoder,s.SetBuffer(i,r),s.StartDecoder(),o=new l.AdaptiveBitModel,c=0;a>c;++c)t.PushBack(s.DecodeAdaptiveBitModel(o));return l.O3DGC_OK},l.CompressedTriangleFans.prototype.Load=function(t,e,n,i){return i===c.O3DGC_STREAM_TYPE_ASCII?(this.LoadUIntData(this.m_numTFANs,t,e),this.LoadUIntData(this.m_degrees,t,e),this.LoadUIntData(this.m_configs,t,e),this.LoadBinData(this.m_operations,t,e),this.LoadIntData(this.m_indices,t,e),n&&this.LoadUIntData(this.m_trianglesOrder,t,e)):(this.LoadIntACEGC(this.m_numTFANs,4,t,e),this.LoadIntACEGC(this.m_degrees,16,t,e),this.LoadUIntAC(this.m_configs,10,t,e),this.LoadBinAC(this.m_operations,t,e),this.LoadIntACEGC(this.m_indices,8,t,e),n&&this.LoadIntACEGC(this.m_trianglesOrder,16,t,e)),l.O3DGC_OK},l.TriangleFans=function(){this.m_verticesAllocatedSize=0,this.m_sizeTFANAllocatedSize=0,this.m_numTFANs=0,this.m_numVertices=0,this.m_sizeTFAN={},this.m_vertices={}},l.TriangleFans.prototype.Allocate=function(t,e){return this.m_numTFANs=0,this.m_numVertices=0,e>this.m_verticesAllocatedSize&&(this.m_verticesAllocatedSize=e,this.m_vertices=new Int32Array(this.m_verticesAllocatedSize)),t>this.m_sizeTFANAllocatedSize&&(this.m_sizeTFANAllocatedSize=t,this.m_sizeTFAN=new Int32Array(this.m_sizeTFANAllocatedSize)),l.O3DGC_OK},l.TriangleFans.prototype.Clear=function(){return this.m_numTFANs=0,this.m_numVertices=0,l.O3DGC_OK},l.TriangleFans.prototype.AddVertex=function(t){var e,n;if(++this.m_numVertices,this.m_numVertices>this.m_verticesAllocatedSize){for(this.m_verticesAllocatedSize*=2,n=new Int32Array(this.m_verticesAllocatedSize),e=0;this.m_numVertices>e;++e)n[e]=this.m_vertices[e];this.m_vertices=n}return this.m_vertices[this.m_numVertices-1]=t,++this.m_sizeTFAN[this.m_numTFANs-1],l.O3DGC_OK},l.TriangleFans.prototype.AddTFAN=function(){var t,e;if(++this.m_numTFANs,this.m_numTFANs>this.m_sizeTFANAllocatedSize){for(this.m_sizeTFANAllocatedSize*=2,e=new Int32Array(this.m_sizeTFANAllocatedSize),t=0;this.m_numTFANs>t;++t)e[t]=this.m_sizeTFAN[t];this.m_sizeTFAN=e}return this.m_sizeTFAN[this.m_numTFANs-1]=this.m_numTFANs>1?this.m_sizeTFAN[this.m_numTFANs-2]:0,l.O3DGC_OK},l.TriangleFans.prototype.Begin=function(t){return t>0?this.m_sizeTFAN[t-1]:0},l.TriangleFans.prototype.End=function(t){return this.m_sizeTFAN[t]},l.TriangleFans.prototype.GetVertex=function(t){return this.m_vertices[t]},l.TriangleFans.prototype.GetTFANSize=function(t){return this.End(t)-this.Begin(t)},l.TriangleFans.prototype.GetNumTFANs=function(){return this.m_numTFANs},l.TriangleFans.prototype.GetNumVertices=function(){return this.m_numVertices},l.TriangleListDecoder=function(){this.m_itNumTFans=new l.Iterator,this.m_itDegree=new l.Iterator,this.m_itConfig=new l.Iterator,this.m_itOperation=new l.Iterator,this.m_itIndex=new l.Iterator,this.m_maxNumVertices=0,this.m_maxNumTriangles=0,this.m_numTriangles=0,this.m_numVertices=0,this.m_tempTrianglesSize=0,this.m_vertexCount=0,this.m_triangleCount=0,this.m_numConqueredTriangles=0,this.m_numVisitedVertices=0,this.m_triangles={},this.m_tempTriangles={},this.m_visitedVertices={},this.m_visitedVerticesValence={},this.m_vertexToTriangle=new l.AdjacencyInfo,this.m_ctfans=new l.CompressedTriangleFans,this.m_tfans=new l.TriangleFans,this.m_streamType=c.O3DGC_STREAM_TYPE_ASCII,this.m_decodeTrianglesOrder=!1,this.m_decodeVerticesOrder=!1,this.m_processConfig={0:function(t,e){var n;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),n=1;e-1>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[1])},1:function(t,e,n){var i,a,r;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),i=1;e-1>i;++i)a=t.m_ctfans.ReadOperation(t.m_itOperation),1===a?(r=t.m_ctfans.ReadIndex(t.m_itIndex),0>r?t.m_tfans.AddVertex(t.m_visitedVertices[-r-1]):t.m_tfans.AddVertex(r+n)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++));t.m_tfans.AddVertex(t.m_visitedVertices[1])},2:function(t,e){var n;for(n=0;e-1>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[0])},3:function(t,e){var n;for(n=0;e-1>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[1])},4:function(t,e){var n;for(t.m_tfans.AddVertex(t.m_visitedVertices[0]),n=1;e>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},5:function(t,e){var n;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),n=1;e>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},6:function(t,e){var n;for(n=0;e>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++)},7:function(t,e){var n;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),n=1;e-1>n;++n)t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++);t.m_tfans.AddVertex(t.m_visitedVertices[0])},8:function(t,e,n){var i,a,r;for(t.m_tfans.AddVertex(t.m_visitedVertices[1]),i=1;e-1>i;++i)a=t.m_ctfans.ReadOperation(t.m_itOperation),1===a?(r=t.m_ctfans.ReadIndex(t.m_itIndex),0>r?t.m_tfans.AddVertex(t.m_visitedVertices[-r-1]):t.m_tfans.AddVertex(r+n)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++));t.m_tfans.AddVertex(t.m_visitedVertices[0])},9:function(t,e,n){var i,a,r;for(i=0;e>i;++i)a=t.m_ctfans.ReadOperation(t.m_itOperation),1===a?(r=t.m_ctfans.ReadIndex(t.m_itIndex),0>r?t.m_tfans.AddVertex(t.m_visitedVertices[-r-1]):t.m_tfans.AddVertex(r+n)):(t.m_visitedVertices[t.m_numVisitedVertices++]=t.m_vertexCount,t.m_tfans.AddVertex(t.m_vertexCount++))}}},l.TriangleListDecoder.prototype.GetStreamType=function(){return this.m_streamType},l.TriangleListDecoder.prototype.GetReorderTriangles=function(){return this.m_decodeTrianglesOrder},l.TriangleListDecoder.prototype.GetReorderVertices=function(){return this.m_decodeVerticesOrder},l.TriangleListDecoder.prototype.SetStreamType=function(t){this.m_streamType=t},l.TriangleListDecoder.prototype.GetVertexToTriangle=function(){return this.m_vertexToTriangle},l.TriangleListDecoder.prototype.Reorder=function(){var t,e,n,i,r,s,o,c;if(this.m_decodeTrianglesOrder)for(t=this.m_triangles,e=this.m_numTriangles,n=this.m_ctfans.m_trianglesOrder.m_data,s=this.m_tempTriangles,s.set(t),i=0,r=0,c=0;e>c;++c)o=a(n[i++])+r,t[3*o]=s[3*c],t[3*o+1]=s[3*c+1],t[3*o+2]=s[3*c+2],r=o+1;return l.O3DGC_OK},l.TriangleListDecoder.prototype.CompueLocalConnectivityInfo=function(t){var e,n,i,a,r,s,o,c,h,p,u,d,g,m,f,v,y,L,_;for(e=this.m_visitedVertices,n=this.m_visitedVerticesValence,i=this.m_triangles,a=this.m_vertexToTriangle,r=a.Begin(t),s=a.End(t),o=0,h=0,y=0,u=r;y>=0&&s>u;++u)if(y=a.GetNeighbor(u),y>=0)for(++o,L=3*y,g=0;3>g;++g)if(_=i[L+g],_>t){for(c=!1,d=0;h>d;++d){if(_===e[d]){n[d]++,c=!0;break}if(e[d]>_){for(++h,m=h-1;m>d;--m)e[m]=e[m-1],n[m]=n[m-1];e[d]=_,n[d]=1,c=!0;break}}c||(e[h]=_,n[h]=1,h++)}if(h>2)for(f=1;h>f;++f)if(1===n[f])for(v=f;v>0&&n[v]<n[v-1];)p=n[v],n[v]=n[v-1],n[v-1]=p,p=e[v],e[v]=e[v-1],e[v-1]=p,--v;return this.m_numConqueredTriangles=o,this.m_numVisitedVertices=h,l.O3DGC_OK},l.TriangleListDecoder.prototype.DecompressTFAN=function(t){var e,n,i,a,r,s,o,c,h,p,u,d,g,m,f,v,y,L,_;if(e=this.m_vertexToTriangle,n=this.m_triangles,i=this.m_itDegree,a=this.m_itConfig,r=this.m_tfans,o=this.m_processConfig,c=this.m_ctfans,h=this.m_triangleCount,p=this.m_numConqueredTriangles,s=c.ReadNumTFans(this.m_itNumTFans),s>0)for(L=0;s>L;++L)for(r.AddTFAN(),u=c.ReadDegree(i)+2-p,d=c.ReadConfig(a),g=r.GetNumVertices(),r.AddVertex(t),o[d](this,u,t),m=r.GetNumVertices(),f=r.GetVertex(g+1),_=g+2;m>_;++_)v=r.GetVertex(_),y=3*h,n[y++]=t,n[y++]=f,n[y]=v,e.AddNeighbor(t,h),e.AddNeighbor(f,h),e.AddNeighbor(v,h),f=v,h++;return this.m_triangleCount=h,l.O3DGC_OK},l.TriangleListDecoder.prototype.Decompress=function(){var t;for(t=0;this.m_numVertices>t;++t)t===this.m_vertexCount&&this.m_vertexCount++,this.CompueLocalConnectivityInfo(t),this.DecompressTFAN(t);return l.O3DGC_OK},l.TriangleListDecoder.prototype.Init=function(t,e,n,i){var a,r;for(this.m_numTriangles=e,this.m_numVertices=n,this.m_triangles=t,this.m_vertexCount=0,this.m_triangleCount=0,this.m_itNumTFans.m_count=0,this.m_itDegree.m_count=0,this.m_itConfig.m_count=0,this.m_itOperation.m_count=0,this.m_itIndex.m_count=0,this.m_numVertices>this.m_maxNumVertices&&(this.m_maxNumVertices=this.m_numVertices,this.m_visitedVerticesValence=new Int32Array(this.m_numVertices),this.m_visitedVertices=new Int32Array(this.m_numVertices)),this.m_decodeTrianglesOrder&&this.m_tempTrianglesSize<this.m_numTriangles&&(this.m_tempTrianglesSize=this.m_numTriangles,this.m_tempTriangles=new Int32Array(3*this.m_tempTrianglesSize)),this.m_ctfans.SetStreamType(this.m_streamType),this.m_ctfans.Allocate(this.m_numVertices,this.m_numTriangles),this.m_tfans.Allocate(2*this.m_numVertices,8*this.m_numVertices),this.m_vertexToTriangle.AllocateNumNeighborsArray(n),r=this.m_vertexToTriangle.GetNumNeighborsBuffer(),a=0;n>a;++a)r[a]=i;return this.m_vertexToTriangle.AllocateNeighborsArray(),this.m_vertexToTriangle.ClearNeighborsArray(),l.O3DGC_OK},l.TriangleListDecoder.prototype.Decode=function(t,e,n,i,a){var r,s;return r=i.ReadUChar(a,this.m_streamType),this.m_decodeTrianglesOrder=0!==(2&r),this.m_decodeVerticesOrder=0!==(1&r),this.m_decodeVerticesOrder?l.O3DGC_ERROR_NON_SUPPORTED_FEATURE:(s=i.ReadUInt32(a,this.m_streamType),this.Init(t,e,n,s),this.m_ctfans.Load(i,a,this.m_decodeTrianglesOrder,this.m_streamType),this.Decompress(),l.O3DGC_OK)},l.SC3DMCDecoder=function(){var t;for(this.m_iterator=new l.Iterator,this.m_streamSize=0,this.m_params=new l.SC3DMCEncodeParams,this.m_triangleListDecoder=new l.TriangleListDecoder,this.m_quantFloatArray={},this.m_orientation={},this.m_normals={},this.m_quantFloatArraySize=0,this.m_normalsSize=0,this.m_orientationSize=0,this.m_stats=new l.SC3DMCStats,this.m_streamType=c.O3DGC_STREAM_TYPE_UNKOWN,this.m_neighbors=[],this.m_idelta=new Float32Array(c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES),this.m_minNormal=new Float32Array(2),this.m_maxNormal=new Float32Array(2),this.m_minNormal[0]=this.m_minNormal[1]=-2,this.m_maxNormal[0]=this.m_maxNormal[1]=2,t=0;c.O3DGC_SC3DMC_MAX_DIM_ATTRIBUTES>t;++t)this.m_neighbors[t]=new l.SC3DMCPredictor},l.SC3DMCDecoder.prototype.GetStats=function(){return this.m_stats},l.SC3DMCDecoder.prototype.DecodeHeader=function(t,e){var n,i,a,r,s,o;if(n=this.m_iterator.m_count,i=e.ReadUInt32(this.m_iterator,c.O3DGC_STREAM_TYPE_BINARY),i!==c.O3DGC_SC3DMC_START_CODE){if(this.m_iterator.m_count=n,i=e.ReadUInt32(this.m_iterator,c.O3DGC_STREAM_TYPE_ASCII),i!==c.O3DGC_SC3DMC_START_CODE)return l.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=c.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=c.O3DGC_STREAM_TYPE_BINARY;if(this.m_streamSize=e.ReadUInt32(this.m_iterator,this.m_streamType),this.m_params.SetEncodeMode(e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetCreaseAngle(e.ReadFloat32(this.m_iterator,this.m_streamType)),a=e.ReadUChar(this.m_iterator,this.m_streamType),t.SetCCW(1===(1&a)),t.SetSolid(1===(2&a)),t.SetConvex(1===(4&a)),t.SetIsTriangularMesh(1===(8&a)),t.SetNCoord(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNNormal(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNumFloatAttributes(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetNumIntAttributes(e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNCoord()>0){for(t.SetNCoordIndex(e.ReadUInt32(this.m_iterator,this.m_streamType)),r=0;3>r;++r)t.SetCoordMin(r,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetCoordMax(r,e.ReadFloat32(this.m_iterator,this.m_streamType));this.m_params.SetCoordQuantBits(e.ReadUChar(this.m_iterator,this.m_streamType))}if(t.GetNNormal()>0){for(t.SetNNormalIndex(e.ReadUInt32(this.m_iterator,this.m_streamType)),r=0;3>r;++r)t.SetNormalMin(r,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetNormalMax(r,e.ReadFloat32(this.m_iterator,this.m_streamType));t.SetNormalPerVertex(1===e.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetNormalQuantBits(e.ReadUChar(this.m_iterator,this.m_streamType))}for(s=0;t.GetNumFloatAttributes()>s;++s)if(t.SetNFloatAttribute(s,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNFloatAttribute(s)>0){for(t.SetNFloatAttributeIndex(s,e.ReadUInt32(this.m_iterator,this.m_streamType)),o=e.ReadUChar(this.m_iterator,this.m_streamType),t.SetFloatAttributeDim(s,o),r=0;o>r;++r)t.SetFloatAttributeMin(s,r,e.ReadFloat32(this.m_iterator,this.m_streamType)),t.SetFloatAttributeMax(s,r,e.ReadFloat32(this.m_iterator,this.m_streamType));t.SetFloatAttributePerVertex(s,1===e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetFloatAttributeType(s,e.ReadUChar(this.m_iterator,this.m_streamType)),this.m_params.SetFloatAttributeQuantBits(s,e.ReadUChar(this.m_iterator,this.m_streamType))}for(s=0;t.GetNumIntAttributes()>s;++s)t.SetNIntAttribute(s,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.GetNIntAttribute(s)>0&&(t.SetNIntAttributeIndex(s,e.ReadUInt32(this.m_iterator,this.m_streamType)),t.SetIntAttributeDim(s,e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetIntAttributePerVertex(s,1===e.ReadUChar(this.m_iterator,this.m_streamType)),t.SetIntAttributeType(s,e.ReadUChar(this.m_iterator,this.m_streamType)));return l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArrayBinary=function(t,e,n,i,a,s,o){var h,p,u,d,g,m,f,v,y,L,_,C,x,w,b,M,z,S,T,E,O,A,D,B,I,k,P,R,V,N,F,j;if(y=this.m_iterator,L=this.m_streamType,C=new l.ArithmeticDecoder,x=new l.StaticBitModel,w=new l.AdaptiveBitModel,b=new l.AdaptiveDataModel,b.SetAlphabet(c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS+1),M=this.m_triangleListDecoder.GetVertexToTriangle(),z=M.m_neighbors,S=a.GetCoordIndex(),T=e*n,E=y.m_count,O=o.ReadUInt32(y,L),A=o.ReadUChar(y,L),D=7&A>>>4,s.m_value=7&A,O-=y.m_count-E,B=new l.Iterator,B.m_count=y.m_count+O,I=0,k=0,P=new l.SC3DMCTriplet(-1,-1,-1),D!==c.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return l.O3DGC_ERROR_CORRUPTED_STREAM;for(v=o.GetBuffer(y,O),y.m_count+=O,C.SetBuffer(O,v),C.StartDecoder(),I=C.ExpGolombDecode(0,x,w),k=C.ExpGolombDecode(0,x,w),R=new l.AdaptiveDataModel,R.SetAlphabet(k+2),V=this.m_neighbors,N=this.m_normals,F=new l.NumberRef,h=s.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION,j=0;e>j;++j){if(F.m_value=0,M.GetNumNeighbors(j)>0&&h)for(m=M.Begin(j),f=M.End(j),d=m;f>d&&(g=z[d],!(0>g));++d)r(S,g,j,F,V,n,t,i);if(F.m_value>1)for(p=C.DecodeAdaptiveDataModel(b),u=0;n>u;++u)_=C.DecodeIntACEGC(R,x,w,I,k),t[j*i+u]=_+V[p].m_pred[u];else if(j>0&&s.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION)for(u=0;n>u;++u)_=C.DecodeIntACEGC(R,x,w,I,k),t[j*i+u]=_+t[(j-1)*i+u];else for(u=0;n>u;++u)_=C.DecodeUIntACEGC(R,x,w,I,k),t[j*i+u]=_}return y.m_count=B.m_count,l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArrayASCII=function(t,e,n,i,a,s,o){var h,p,u,d,g,m,f,v,y,L,_,C,x,w,b,M,z,S,T,E,O,A,D,B;if(p=this.m_iterator,u=this.m_streamType,g=this.m_triangleListDecoder.GetVertexToTriangle(),m=g.m_neighbors,f=a.GetCoordIndex(),v=e*n,y=p.m_count,L=o.ReadUInt32(p,u),_=o.ReadUChar(p,u),C=7&_>>>4,s.m_value=7&_,L-=p.m_count-y,x=new l.Iterator,x.m_count=p.m_count+L,w=new l.SC3DMCTriplet(-1,-1,-1),C!==c.O3DGC_SC3DMC_BINARIZATION_ASCII)return l.O3DGC_ERROR_CORRUPTED_STREAM;for(o.ReadUInt32(x,u),b=this.m_neighbors,M=this.m_normals,z=new l.NumberRef,h=s.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION,S=0;e>S;++S){if(z.m_value=0,g.GetNumNeighbors(S)>0&&h)for(T=g.Begin(S),E=g.End(S),O=T;E>O&&(A=m[O],!(0>A));++O)r(f,A,S,z,b,n,t,i);if(z.m_value>1)for(B=o.ReadUCharASCII(x),D=0;n>D;++D)d=o.ReadIntASCII(p),t[S*i+D]=d+b[B].m_pred[D];else if(S>0&&s.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION)for(D=0;n>D;++D)d=o.ReadIntASCII(p),t[S*i+D]=d+t[(S-1)*i+D];else for(D=0;n>D;++D)d=o.ReadUIntASCII(p),t[S*i+D]=d}return p.m_count=x.m_count,l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeIntArray=function(t,e,n,i,a,r,s){return this.m_streamType===c.O3DGC_STREAM_TYPE_ASCII?this.DecodeIntArrayASCII(t,e,n,i,a,r,s):this.DecodeIntArrayBinary(t,e,n,i,a,r,s)},l.SC3DMCDecoder.prototype.ProcessNormals=function(t){var e,i,a,r,s,c,h,p,u,d,g,m,f,v,y;for(a=t.GetNNormal(),r=3*t.GetNNormal(),r>this.m_normalsSize&&(this.m_normalsSize=r,this.m_normals=new Float32Array(this.m_normalsSize)),s=this.m_normals,c=this.m_quantFloatArray,h=this.m_orientation,p=t.GetCoordIndex(),o(p,t.GetNCoordIndex(),c,a,s),u=new l.Vec3,d=new l.Vec3,g=0;a>g;++g)e=3*g,u.m_x=s[e],u.m_y=s[e+1],u.m_z=s[e+2],y=Math.sqrt(u.m_x*u.m_x+u.m_y*u.m_y+u.m_z*u.m_z),0===y&&(y=1),n(u,d),m=d.m_x/y,f=d.m_y/y,v=d.m_z+h[g],h[g]=v,v>>>1!==d.m_z>>>1&&(m=0,f=0),i=2*g,s[i]=m,s[i+1]=f;return l.O3DGC_OK},l.SC3DMCDecoder.prototype.IQuantize=function(t,e,n,i,a,r,s,o){var h,p,u,d,g,m;if(o.m_value===c.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION)for(m=c.CubeToSphere,d=this.m_orientation,g=this.m_normals,p=new l.Vec3(0,0,0),u=new l.Vec3(0,0,0),this.IQuantizeFloatArray(t,e,n,i,this.m_minNormal,this.m_maxNormal,s+1),h=0;e>h;++h)p.m_x=t[i*h]+g[2*h],p.m_y=t[i*h+1]+g[2*h+1],p.m_z=d[h],m[p.m_z](p,u),t[i*h]=u.m_x,t[i*h+1]=u.m_y,t[i*h+2]=u.m_z;else this.IQuantizeFloatArray(t,e,n,i,a,r,s)},l.SC3DMCDecoder.prototype.DecodeFloatArrayBinary=function(t,e,n,i,o,h,p,u,d,g){var m,f,v,y,L,_,C,x,w,b,M,z,S,T,E,O,A,D,B,I,k,P,R,V,N,F,j,G,q,H,U,W,Y,X,Z,K;if(A=this.m_iterator,D=this.m_orientation,B=this.m_streamType,k=new l.ArithmeticDecoder,P=new l.StaticBitModel,R=new l.AdaptiveBitModel,V=new l.AdaptiveDataModel,m=c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,V.SetAlphabet(m+1),N=this.m_triangleListDecoder.GetVertexToTriangle(),F=N.m_neighbors,j=u.GetCoordIndex(),G=e*n,q=A.m_count,H=g.ReadUInt32(A,B),U=g.ReadUChar(A,B),W=7&U>>>4,d.m_value=7&U,H-=A.m_count-q,Y=new l.Iterator,Y.m_count=A.m_count+H,X=0,Z=0,W!==c.O3DGC_SC3DMC_BINARIZATION_AC_EGC)return l.O3DGC_ERROR_CORRUPTED_STREAM;if(_=g.GetBuffer(A,H),A.m_count+=H,k.SetBuffer(H,_),k.StartDecoder(),X=k.ExpGolombDecode(0,P,R),Z=k.ExpGolombDecode(0,P,R),K=new l.AdaptiveDataModel,K.SetAlphabet(Z+2),d.m_value===c.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(G>this.m_orientationSize&&(this.m_orientationSize=G,this.m_orientation=new Int8Array(this.m_orientationSize),D=this.m_orientation),L=new l.AdaptiveDataModel,L.SetAlphabet(12),z=0;e>z;++z)D[z]=a(k.DecodeAdaptiveDataModel(L));this.ProcessNormals(u),n=2}for(G>this.m_quantFloatArraySize&&(this.m_quantFloatArraySize=G,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),C=this.m_quantFloatArray,x=this.m_neighbors,w=this.m_normals,b=new l.NumberRef,f=d.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION,v=d.m_value===c.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,S=0;e>S;++S){if(b.m_value=0,N.GetNumNeighbors(S)>0&&f){if(E=N.Begin(S),O=N.End(S),v)for(T=E;O>T&&(M=F[T],!(0>M));++T)s(j,M,S,b,x,n,C,i,N,F);if(m>b.m_value)for(T=E;O>T&&(M=F[T],!(0>M));++T)r(j,M,S,b,x,n,C,i)}if(b.m_value>1)for(y=k.DecodeAdaptiveDataModel(V),z=0;n>z;++z)I=k.DecodeIntACEGC(K,P,R,X,Z),C[S*i+z]=I+x[y].m_pred[z];else if(S>0&&f)for(z=0;n>z;++z)I=k.DecodeIntACEGC(K,P,R,X,Z),C[S*i+z]=I+C[(S-1)*i+z];else for(z=0;n>z;++z)I=k.DecodeUIntACEGC(K,P,R,X,Z),C[S*i+z]=I}return A.m_count=Y.m_count,this.IQuantize(t,e,n,i,o,h,p,d),l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeFloatArrayASCII=function(t,e,n,i,a,o,h,p,u,d){var g,m,f,v,y,L,_,C,x,w,b,M,z,S,T,E,O,A,D,B,I,k,P,R,V,N,F;if(g=c.O3DGC_SC3DMC_MAX_PREDICTION_NEIGHBORS,v=this.m_iterator,y=this.m_orientation,L=this.m_streamType,C=this.m_triangleListDecoder.GetVertexToTriangle(),x=C.m_neighbors,w=p.GetCoordIndex(),b=e*n,M=v.m_count,z=d.ReadUInt32(v,L),S=d.ReadUChar(v,L),T=7&S>>>4,u.m_value=7&S,z-=v.m_count-M,E=new l.Iterator,E.m_count=v.m_count+z,T!==c.O3DGC_SC3DMC_BINARIZATION_ASCII)return l.O3DGC_ERROR_CORRUPTED_STREAM;if(d.ReadUInt32(E,L),u.m_value===c.O3DGC_SC3DMC_SURF_NORMALS_PREDICTION){for(e>this.m_orientationSize&&(this.m_orientationSize=e,this.m_orientation=new Int8Array(this.m_orientationSize),y=this.m_orientation),N=0;e>N;++N)y[N]=d.ReadIntASCII(v);this.ProcessNormals(p),n=2}for(b>this.m_quantFloatArraySize&&(this.m_quantFloatArraySize=b,this.m_quantFloatArray=new Int32Array(this.m_quantFloatArraySize)),O=this.m_quantFloatArray,A=this.m_neighbors,D=this.m_normals,B=new l.NumberRef,m=u.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION,f=u.m_value===c.O3DGC_SC3DMC_PARALLELOGRAM_PREDICTION,I=0;e>I;++I){if(B.m_value=0,C.GetNumNeighbors(I)>0&&m){if(P=C.Begin(I),R=C.End(I),f)for(k=P;R>k&&(V=x[k],!(0>V));++k)s(w,V,I,B,A,n,O,i,C,x);if(g>B.m_value)for(k=P;R>k&&(V=x[k],!(0>V));++k)r(w,V,I,B,A,n,O,i)}if(B.m_value>1)for(F=d.ReadUCharASCII(E),N=0;n>N;++N)_=d.ReadIntASCII(v),O[I*i+N]=_+A[F].m_pred[N];else if(I>0&&u.m_value!==c.O3DGC_SC3DMC_NO_PREDICTION)for(N=0;n>N;++N)_=d.ReadIntASCII(v),O[I*i+N]=_+O[(I-1)*i+N];else for(N=0;n>N;++N)_=d.ReadUIntASCII(v),O[I*i+N]=_}return v.m_count=E.m_count,this.IQuantize(t,e,n,i,a,o,h,u),l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodeFloatArray=function(t,e,n,i,a,r,s,o,l,h){return this.m_streamType===c.O3DGC_STREAM_TYPE_ASCII?this.DecodeFloatArrayASCII(t,e,n,i,a,r,s,o,l,h):this.DecodeFloatArrayBinary(t,e,n,i,a,r,s,o,l,h)},l.SC3DMCDecoder.prototype.IQuantizeFloatArray=function(t,e,n,i,a,r,s){var o,c,h,p,u;for(o=this.m_idelta,c=this.m_quantFloatArray,h=0;n>h;++h)p=r[h]-a[h],o[h]=p>0?p/((1<<s>>>0)-1):1;for(u=0;e>u;++u)for(h=0;n>h;++h)t[u*i+h]=c[u*i+h]*o[h]+a[h];return l.O3DGC_OK},l.SC3DMCDecoder.prototype.DecodePlayload=function(t,e){var n,i,a,r,s,o,c;if(n=this.m_params,i=this.m_iterator,a=this.m_stats,r=new l.NumberRef,s=new l.Timer,o=l.O3DGC_OK,this.m_triangleListDecoder.SetStreamType(this.m_streamType),a.m_streamSizeCoordIndex=i.m_count,s.Tic(),this.m_triangleListDecoder.Decode(t.GetCoordIndex(),t.GetNCoordIndex(),t.GetNCoord(),e,i),s.Toc(),a.m_timeCoordIndex=s.GetElapsedTime(),a.m_streamSizeCoordIndex=i.m_count-a.m_streamSizeCoordIndex,a.m_streamSizeCoord=i.m_count,s.Tic(),t.GetNCoord()>0&&(o=this.DecodeFloatArray(t.GetCoord(),t.GetNCoord(),3,3,t.GetCoordMinArray(),t.GetCoordMaxArray(),n.GetCoordQuantBits(),t,r,e),n.SetCoordPredMode(r.m_value)),o!==l.O3DGC_OK)return o;if(s.Toc(),a.m_timeCoord=s.GetElapsedTime(),a.m_streamSizeCoord=i.m_count-a.m_streamSizeCoord,a.m_streamSizeNormal=i.m_count,s.Tic(),t.GetNNormal()>0&&(o=this.DecodeFloatArray(t.GetNormal(),t.GetNNormal(),3,3,t.GetNormalMinArray(),t.GetNormalMaxArray(),n.GetNormalQuantBits(),t,r,e),n.SetNormalPredMode(r.m_value)),o!==l.O3DGC_OK)return o;for(s.Toc(),a.m_timeNormal=s.GetElapsedTime(),a.m_streamSizeNormal=i.m_count-a.m_streamSizeNormal,c=0;t.GetNumFloatAttributes()>c;++c)a.m_streamSizeFloatAttribute[c]=i.m_count,s.Tic(),o=this.DecodeFloatArray(t.GetFloatAttribute(c),t.GetNFloatAttribute(c),t.GetFloatAttributeDim(c),t.GetFloatAttributeDim(c),t.GetFloatAttributeMinArray(c),t.GetFloatAttributeMaxArray(c),n.GetFloatAttributeQuantBits(c),t,r,e),n.SetFloatAttributePredMode(c,r.m_value),s.Toc(),a.m_timeFloatAttribute[c]=s.GetElapsedTime(),a.m_streamSizeFloatAttribute[c]=i.m_count-a.m_streamSizeFloatAttribute[c];if(o!==l.O3DGC_OK)return o;for(c=0;t.GetNumIntAttributes()>c;++c)a.m_streamSizeIntAttribute[c]=i.m_count,s.Tic(),o=this.DecodeIntArray(t.GetIntAttribute(c),t.GetNIntAttribute(c),t.GetIntAttributeDim(c),t.GetIntAttributeDim(c),t,r,e),n.SetIntAttributePredMode(c,r.m_value),s.Toc(),a.m_timeIntAttribute[c]=s.GetElapsedTime(),a.m_streamSizeIntAttribute[c]=i.m_count-a.m_streamSizeIntAttribute[c];return o!==l.O3DGC_OK?o:(s.Tic(),this.m_triangleListDecoder.Reorder(),s.Toc(),a.m_timeReorder=s.GetElapsedTime(),o)},l.DVEncodeParams=function(){this.m_encodeMode=c.O3DGC_DYNAMIC_VECTOR_ENCODE_MODE_LIFT,this.m_streamTypeMode=c.O3DGC_STREAM_TYPE_ASCII,this.m_quantBits=10},l.DVEncodeParams.prototype.GetStreamType=function(){return this.m_streamTypeMode},l.DVEncodeParams.prototype.GetEncodeMode=function(){return this.m_encodeMode},l.DVEncodeParams.prototype.GetQuantBits=function(){return this.m_quantBits},l.DVEncodeParams.prototype.SetStreamType=function(t){this.m_streamTypeMode=t},l.DVEncodeParams.prototype.SetEncodeMode=function(t){this.m_encodeMode=t},l.DVEncodeParams.prototype.SetQuantBits=function(t){this.m_quantBits=t},l.DynamicVector=function(){this.m_num=0,this.m_dim=0,this.m_stride=0,this.m_max={},this.m_min={},this.m_vectors={}},l.DynamicVector.prototype.GetNVector=function(){return this.m_num},l.DynamicVector.prototype.GetDimVector=function(){return this.m_dim},l.DynamicVector.prototype.GetStride=function(){return this.m_stride},l.DynamicVector.prototype.GetMinArray=function(){return this.m_min},l.DynamicVector.prototype.GetMaxArray=function(){return this.m_max},l.DynamicVector.prototype.GetVectors=function(){return this.m_vectors},l.DynamicVector.prototype.GetMin=function(t){return this.m_min[t]},l.DynamicVector.prototype.GetMax=function(t){return this.m_max[t]},l.DynamicVector.prototype.SetNVector=function(t){this.m_num=t},l.DynamicVector.prototype.SetDimVector=function(t){this.m_dim=t},l.DynamicVector.prototype.SetStride=function(t){this.m_stride=t},l.DynamicVector.prototype.SetMinArray=function(t){this.m_min=t},l.DynamicVector.prototype.SetMaxArray=function(t){this.m_max=t},l.DynamicVector.prototype.SetMin=function(t,e){this.m_min[t]=e},l.DynamicVector.prototype.SetMax=function(t,e){this.m_max[t]=e},l.DynamicVector.prototype.SetVectors=function(t){this.m_vectors=t},l.DynamicVectorDecoder=function(){this.m_streamSize=0,this.m_maxNumVectors=0,this.m_numVectors=0,this.m_dimVectors=0,this.m_quantVectors={},this.m_iterator=new l.Iterator,this.m_streamType=c.O3DGC_STREAM_TYPE_UNKOWN,this.m_params=new l.DVEncodeParams},l.DynamicVectorDecoder.prototype.GetStreamType=function(){return this.m_streamType},l.DynamicVectorDecoder.prototype.GetIterator=function(){return this.m_iterator},l.DynamicVectorDecoder.prototype.SetStreamType=function(t){this.m_streamType=t},l.DynamicVectorDecoder.prototype.SetIterator=function(t){this.m_iterator=t},l.DynamicVectorDecoder.prototype.IUpdate=function(t,e,n){var i,a;for(a=n-1,i=2,t[e]-=t[e+1]>>1;a>i;)t[e+i]-=t[e+i-1]+t[e+i+1]+2>>2,i+=2;return i===a&&(t[e+i]-=t[e+i-1]>>1),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.IPredict=function(t,e,n){var i,a;for(a=n-1,i=1;a>i;)t[e+i]+=t[e+i-1]+t[e+i+1]+1>>1,i+=2;return i===a&&(t[e+i]+=t[e+i-1]),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.Merge=function(t,e,n){var i,a,r,s,o;for(a=(n>>1)+(1&n),r=a-1,s=a;r>0;){for(i=r;s>i;i+=2)o=t[e+i],t[e+i]=t[e+i+1],t[e+i+1]=o;--r,++s}return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.ITransform=function(t,e,n){var i,a,r,s;for(i=n,a=0,r=0,a+=(1&i)<<r++>>>0;i>1;)i=(i>>1)+((1&i)>>>0),a+=(1&i)<<r++>>>0;for(s=r-2;s>=0;--s)i=(i<<1>>>0)-(1&a>>>s)>>>0,this.Merge(t,e,i),this.IUpdate(t,e,i),this.IPredict(t,e,i);return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.IQuantize=function(t,e,n,i,a,r,s){var o,c,h,p,u,d;for(o=this.m_quantVectors,p=e*n,u=0;n>u;++u)for(c=r[u]-a[u],h=c>0?c/((1<<s>>>0)-1):1,d=0;e>d;++d)t[d*i+u]=o[d+u*e]*h+a[u];return l.O3DGC_OK},l.DynamicVectorDecoder.prototype.DecodeHeader=function(t,e){var n,i,a,r;if(n=this.m_iterator,i=n.m_count,a=e.ReadUInt32(n,c.O3DGC_STREAM_TYPE_BINARY),a!==c.O3DGC_DV_START_CODE){if(n.m_count=i,a=e.ReadUInt32(n,c.O3DGC_STREAM_TYPE_ASCII),a!==c.O3DGC_DV_START_CODE)return l.O3DGC_ERROR_CORRUPTED_STREAM;this.m_streamType=c.O3DGC_STREAM_TYPE_ASCII}else this.m_streamType=c.O3DGC_STREAM_TYPE_BINARY;return r=this.m_streamType,this.m_streamSize=e.ReadUInt32(n,r),this.m_params.SetEncodeMode(e.ReadUChar(n,r)),t.SetNVector(e.ReadUInt32(n,r)),t.GetNVector()>0&&(t.SetDimVector(e.ReadUInt32(n,r)),this.m_params.SetQuantBits(e.ReadUChar(n,r))),l.O3DGC_OK},l.DynamicVectorDecoder.prototype.DecodePlayload=function(t,e){var n,i,a,r,s,o,h,p,u,d,g,m,f,v,y,L,_,C,x;for(i=this.m_iterator,a=this.m_streamType,r=l.O3DGC_OK,s=i.m_count,o=e.ReadUInt32(i,a),h=t.GetDimVector(),p=t.GetNVector(),n=h*p,u=0;t.GetDimVector()>u;++u)t.SetMin(u,e.ReadFloat32(i,a)),t.SetMax(u,e.ReadFloat32(i,a));if(d=new l.ArithmeticDecoder,g=new l.StaticBitModel,m=new l.AdaptiveBitModel,o-=i.m_count-s,f=0,v=0,a===c.O3DGC_STREAM_TYPE_BINARY&&(y=e.GetBuffer(i,o),i.m_count+=o,d.SetBuffer(o,y),d.StartDecoder(),f=d.ExpGolombDecode(0,g,m),v=d.ExpGolombDecode(0,g,m)),L=new l.AdaptiveDataModel,L.SetAlphabet(v+2),n>this.m_maxNumVectors&&(this.m_maxNumVectors=n,this.m_quantVectors=new Int32Array(this.m_maxNumVectors)),_=this.m_quantVectors,a===c.O3DGC_STREAM_TYPE_ASCII)for(C=0;p>C;++C)for(x=0;h>x;++x)_[x*p+C]=e.ReadIntASCII(i);else for(C=0;p>C;++C)for(x=0;h>x;++x)_[x*p+C]=d.DecodeIntACEGC(L,g,m,f,v);
for(x=0;h>x;++x)this.ITransform(_,x*p,p);return this.IQuantize(t.GetVectors(),p,h,t.GetStride(),t.GetMinArray(),t.GetMaxArray(),this.m_params.GetQuantBits()),r},l}();