montageDefine("3d2b056","runtime/scene-helper",{dependencies:["runtime/dependencies/gl-matrix","montage","montage/core/uuid","runtime/glTF-scene","runtime/glTF-node","runtime/scene","runtime/node","runtime/scene-renderer","runtime/glTF-material","runtime/utilities","runtime/projection","runtime/camera","collections/set","runtime/material"],factory:function(t,e){t("runtime/dependencies/gl-matrix");var n=t("montage").Montage,i=t("montage/core/uuid").Uuid;t("runtime/glTF-scene").glTFScene;var r=t("runtime/glTF-node").glTFNode;t("runtime/scene").Scene;var a=t("runtime/node").Node;t("runtime/scene-renderer").SceneRenderer,t("runtime/glTF-material").glTFMaterial,t("runtime/utilities").Utilities;var s=t("runtime/projection").Projection,o=t("runtime/camera").Camera;t("runtime/utilities").BBox;var l=t("collections/set"),c=t("runtime/material").Material,h=e.SceneHelper=Object.create(Object.prototype,{getGLTFViewPoints:{value:function(t){var e=[],n=t.glTFElement.rootNode;return n.apply(function(t){return t.cameras&&t.cameras.length&&(e=e.concat(t)),null},!0,null),e}},getViewPoints:{value:function(t){var e=this.getGLTFViewPoints(t),i=[];return e.forEach(function(e){var r=n.create(a);r.scene=t,r.id=e.baseId,i.push(r)},this),i}},createGLTFNodeIncludingCamera:{value:function(t){var e=Object.create(s);e.initWithDescription({type:"perspective",perspective:{yfov:45,aspectRatio:1,znear:.1,zfar:100}});var n=Object.create(o).init();n.projection=e;var a=Object.create(r).init();return n.name=a.name=t,a.id=i.generate(),a.baseId=a.id,a.cameras.push(n),a}},createNodeIncludingCamera:{value:function(t,e){var i=h.createGLTFNodeIncludingCamera(t),r=e.glTFElement;r.ids[i.baseId]=i;var s=n.create(a);return s.scene=e,s.id=i.baseId,s}},getMaterialsFromNode:{value:function(t){var e=t.glTFElement,i=new l,r=t.scene;return null!=e.meshes&&e.meshes.forEach(function(t){t.primitives&&t.primitives.forEach(function(t){var e,a=t.material;null==a.component3D?(e=n.create(c),e.scene=r,e.id=a.baseId,r.glTFElement.ids[a.baseId]=a,a.component3D=e):e=a.component3D,i.add(e)},this)},this),i}},createNodeFromGlTFElementIfNeeded:{value:function(t,e){if(null!=t.component3D)return t.component3D;var n=new a;return e.glTFElement.ids[t.baseId]=t,n.scene=e,n.id=t.baseId,t.component3D=n,n}},getGLTFCamera:{value:function(t){var e=null;if(t.glTFElement){var n=t.glTFElement;null!=n.cameras&&n.cameras.length>0&&(e=n.cameras[0])}return e}}})}});