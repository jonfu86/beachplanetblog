require("runtime/dependencies/gl-matrix");var Base=require("runtime/base").Base,KeyframeAnimation=require("runtime/animation").KeyframeAnimation,BasicAnimation=require("runtime/animation").BasicAnimation,Animation=require("runtime/animation").Animation;exports.AnimationManager=Object.create(Base,{startTime:{get:function(){if(this.animations){if(this.animations.length>0){for(var t=this.animations[0].startTime,e=1;this.animations.length>e;e++)t>this.animations[e].startTime&&(t=this.animations[e].startTime);return t}return 0}}},endTime:{get:function(){if(this.animations){if(this.animations.length>0){for(var t=this.animations[0].endTime,e=1;this.animations.length>e;e++)this.animations[e].endTime>t&&(t=this.animations[e].endTime);return t}return-1}}},_animations:{value:null,writable:!0},animations:{get:function(){return this._animations},set:function(t){this._animations!=t&&(this._animations=t)}},_sceneTime:{value:0,writable:!0},sceneTime:{get:function(){return this._sceneTime},set:function(t){this._delegate&&this._delegate.sceneTimeWillChange&&this._delegate.sceneTimeWillChange(this,t),this._sceneTime=t,this._delegate&&this._delegate.sceneTimeDidChange&&this._delegate.sceneTimeDidChange(this)}},_delegate:{value:0,writable:!0},delegate:{get:function(){return this._delegate},set:function(t){this._delegate=t}},targets:{get:function(){var t=[];return null!=this._animations&&this._animations.forEach(function(e){e.type==Animation.KEYFRAME?e.channels.forEach(function(e){t.push(e.target.id)},this):e.type==Animation.BASIC},this),t}},hasAnimation:{value:function(t,e){return null==this._animations?!1:(null==e&&(e=this.targets),-1!==e.indexOf(t))}},nodeHasAnimatedAncestor:{value:function(t){do{if(this.hasAnimation(t.id))return!0;t=t.parent}while(null!=t);return!1}},updateTargetsAtTime:{value:function(t,e){this.animations&&this.animations.forEach(function(n){n.type==Animation.KEYFRAME?n.updateTargetsAtTime(t,e):n.type==Animation.BASIC},this)}},evaluateAtTime:{value:function(t){this._activeAnimations&&this._activeAnimations.forEach(function(e){e.type==Animation.KEYFRAME||e.type==Animation.BASIC&&e._evaluateAtTime(t)},this)}},hasActiveAnimations:{value:function(){return this._activeAnimations.length>0}},_activeAnimations:{value:0,writable:!0},_removeAnimationAtIndex:{value:function(t){var e=this._activeAnimations[t];e.delegate&&e.delegate.animationDidStop(e),this._activeAnimations.splice(t,1)}},playAnimation:{value:function(t){var e=this;this._activeAnimations.push(t),t.delegate&&t.delegate.animationDidStart(t),setTimeout(function(){var n=e._activeAnimations.indexOf(t);-1!==n&&e._removeAnimationAtIndex(n)},t.duration)}},init:{value:function(){return this.__Base_init(),this.animations=[],this._activeAnimations=[],this}},removeAnimationWithTargetAndPath:{value:function(t,e){if(this._activeAnimations)for(var n=0;this._activeAnimations.length>n;n++){var i=this._activeAnimations[n];if(i.target===t&&i.path==e)return this._removeAnimationAtIndex(n),void 0}}}});